debug: True
---------------------------------------- config ----------------------------------------
{'debug': True, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/lm_diagnostic_extended/sgpl/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'probAvg', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'add_wordnet_path_score': True, 'anchor_probe': 'plural_probe', 'anchor_col': 'subj_anchors', 'anchor_col_sg': 'subj_anchors_sg', 'anchor_col_pl': 'subj_anchors_pl', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [5], 'max_anchor_num': 5}
---------------------------------------- config ----------------------------------------
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "A [X] is a [MASK].",
            "A [X] is an [MASK].",
            "An [X] is a [MASK].",
            "An [X] is an [MASK]."
        ],
        "def_dap": [
            "A [X] or [Z] is a [MASK].",
            "A [X] or [Z] is an [MASK].",
            "An [X] or [Z] is a [MASK].",
            "An [X] or [Z] is an [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/lm_diagnostic_extended/sgpl//IsA.jsonl
#Test_instances: 576
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
	 step3: fill mask in dap anchors
  0%|          | 0/5 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 40%|████      | 2/5 [00:00<00:00, 13.23it/s] 80%|████████  | 4/5 [00:00<00:00, 13.40it/s]100%|██████████| 5/5 [00:00<00:00, 13.38it/s]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:00<00:00,  8.00it/s] 40%|████      | 2/5 [00:00<00:00,  8.01it/s] 60%|██████    | 3/5 [00:00<00:00,  8.05it/s] 80%|████████  | 4/5 [00:00<00:00,  8.08it/s]100%|██████████| 5/5 [00:00<00:00,  8.07it/s]100%|██████████| 5/5 [00:00<00:00,  8.05it/s]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:00<00:01,  2.73it/s] 40%|████      | 2/5 [00:00<00:01,  2.71it/s] 60%|██████    | 3/5 [00:01<00:00,  2.66it/s] 80%|████████  | 4/5 [00:01<00:00,  2.67it/s]100%|██████████| 5/5 [00:01<00:00,  2.69it/s]100%|██████████| 5/5 [00:01<00:00,  2.69it/s]
     sub_label      obj_label             masked_sentences  uuid relation sub_label_pl  sub_position sub_label_sg                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                           subj_sgpl                                  subj_anchors                                 subj_anchors_score                         subj_anchors_sg                               subj_anchors_pl               subj_anchors_combined                  masked_sentences_with_subj_anchor  \
0      gravers  [tool, tools]      [A graver is a [MASK].]     1      IsA      gravers             2       graver    [A graver is a [MASK]., A graver is an [MASK].]  [A graver or [Z] is a [MASK]., A graver or [Z]...  [[MASK] such as gravers., [MASK], including gr...  [[MASK] such as gravers and [Z]., [MASK], incl...  [such as gravers and [MASK]., such as gravers ...  [digger, shovel, tool, grave, coffin, person, ...  {'digger': 0.040751419961452484, 'shovel': 0.0...  [object, undertaker, oven, digger, shovel, ani...  {'object': 0.09570128470659256, 'undertaker': ...  [people, graves, dead, workers, burials, decea...  {'people': 0.12487430833280086, 'graves': 0.12...              gravers graver gravers  [markers, tombs, graves, bodies, collectors]  {'markers': 0.17831640566388765, 'tombs': 0.16...  [marker, tomb, grafe, body, collector]  [markers, tombs, graves, bodies, collectors]              gravers graver gravers  [A graver is a [MASK]., A graver  or markers i...   
1  smallmouths         [fish]  [A smallmouth is a [MASK].]     2      IsA  smallmouths             2   smallmouth  [A smallmouth is a [MASK]., A smallmouth is an...  [A smallmouth or [Z] is a [MASK]., A smallmout...  [[MASK] such as smallmouths., [MASK], includin...  [[MASK] such as smallmouths and [Z]., [MASK], ...  [such as smallmouths and [MASK]., such as smal...  [fish, catfish, salmon, shark, trout, swimmer,...  {'fish': 0.7577883005142212, 'catfish': 0.1664...  [eel, fish, otter, catfish, alligator, estuary...  {'eel': 0.4893859028816223, 'fish': 0.39916982...  [fish, catfish, species, things, animals, fish...  {'fish': 0.3825688896079858, 'catfish': 0.3376...  smallmouths smallmouth smallmouths            [catfish, carp, bass, pike, perch]  {'catfish': 0.8201920868772449, 'carp': 0.2299...      [catfish, carp, bass, pike, perch]      [catfishes, carp, basses, pike, perches]  smallmouths smallmouth smallmouths  [A smallmouth is a [MASK]., A smallmouth  or c...   
2     pelicans  [bird, birds]     [A pelican is a [MASK].]     3      IsA     pelicans             2      pelican  [A pelican is a [MASK]., A pelican is an [MASK].]  [A pelican or [Z] is a [MASK]., A pelican or [...  [[MASK] such as pelicans., [MASK], including p...  [[MASK] such as pelicans and [Z]., [MASK], inc...  [such as pelicans and [MASK]., such as pelican...  [bird, parrot, penguin, dolphin, fish, dog, pi...  {'bird': 0.4259684085845947, 'parrot': 0.09353...  [animal, bird, parrot, penguin, dolphin, ancho...  {'animal': 0.687469482421875, 'bird': 0.425968...  [birds, animals, things, dolphins, species, sh...  {'birds': 0.45262210816144943, 'animals': 0.20...           pelicans pelican pelicans    [dolphins, penguins, ducks, swans, cranes]  {'dolphins': 0.2766755797437854, 'penguins': 0...   [dolphin, penguin, duck, swan, crane]    [dolphins, penguins, ducks, swans, cranes]           pelicans pelican pelicans  [A pelican is a [MASK]., A pelican  or dolphin...   
3   sapsuckers  [bird, birds]   [A sapsucker is a [MASK].]     4      IsA   sapsuckers             2    sapsucker  [A sapsucker is a [MASK]., A sapsucker is an [...  [A sapsucker or [Z] is a [MASK]., A sapsucker ...  [[MASK] such as sapsuckers., [MASK], including...  [[MASK] such as sapsuckers and [Z]., [MASK], i...  [such as sapsuckers and [MASK]., such as sapsu...  [snake, worm, spider, bug, lizard, predator, t...  {'snake': 0.09990766644477844, 'worm': 0.06063...  [insect, animal, snake, worm, spider, bug, liz...  {'insect': 0.42818304896354675, 'animal': 0.33...  [snakes, things, reptiles, animals, insects, p...  {'snakes': 0.2790814429521561, 'things': 0.163...     sapsuckers sapsucker sapsuckers   [snakes, spiders, monsters, frogs, lizards]  {'snakes': 0.36424588378180156, 'spiders': 0.1...  [snake, spider, monster, frog, lizard]   [snakes, spiders, monsters, frogs, lizards]     sapsuckers sapsucker sapsuckers  [A sapsucker is a [MASK]., A sapsucker  or sna...   
4        makos         [fish]        [A mako is a [MASK].]     5      IsA        makos             2         mako        [A mako is a [MASK]., A mako is an [MASK].]  [A mako or [Z] is a [MASK]., A mako or [Z] is ...  [[MASK] such as makos., [MASK], including mako...  [[MASK] such as makos and [Z]., [MASK], includ...  [such as makos and [MASK]., such as makos or [...  [fish, canoe, drum, dog, boat, drummer, bird, ...  {'fish': 0.03543541207909584, 'canoe': 0.02775...  [animal, elephant, object, fish, instrument, c...  {'animal': 0.23357057571411133, 'elephant': 0....  [stories, poems, things, artists, people, anim...  {'stories': 0.15202218294143677, 'poems': 0.10...                    makos mako makos         [birds, human, chiefs, blacks, drums]  {'birds': 0.11706465586192077, 'human': 0.1013...       [bird, human, chief, black, drum]        [birds, humans, chiefs, blacks, drums]                    makos mako makos  [A mako is a [MASK]., A mako  or birds is a [M...   

                            def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                              obj_mask_sentence_dap                        obj_mask_sentence_dap_score                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [A graver or marker is a [MASK]., A graver or ...  [[MASK] such as gravers and markers., [MASK] s...  [collector, tomb, marker, corpse, person, tool...  {'collector': 0.1369161158800125, 'tomb': 0.12...  [object, corpse, person, axe, body, tomb, grav...  {'object': 0.3579081496223807, 'corpse': 0.210...  [things, graves, burials, cemeteries, objects,...  {'things': 0.21988790271182854, 'graves': 0.13...  
1  [A smallmouth or catfish is a [MASK]., A small...  [[MASK] such as smallmouths and catfishes., [M...  [fish, catfish, trout, shark, salmon, carp, ba...  {'fish': 0.7731746037801107, 'catfish': 0.1652...  [fish, example, catfish, eel, intermediate, ot...  {'fish': 0.44446873012930155, 'example': 0.444...  [fish, species, catfish, bass, fishes, animals...  {'fish': 0.534948677321275, 'species': 0.20416...  
2  [A pelican or dolphin is a [MASK]., A pelican ...  [[MASK] such as pelicans and dolphins., [MASK]...  [bird, dolphin, penguin, duck, crane, parrot, ...  {'bird': 0.510427501052618, 'dolphin': 0.14558...  [bird, animal, example, penguin, crane, dolphi...  {'bird': 0.49983870089054105, 'animal': 0.4816...  [birds, animals, species, things, dolphins, wh...  {'birds': 0.6400286891808112, 'animals': 0.155...  
3  [A sapsucker or snake is a [MASK]., A sapsucke...  [[MASK] such as sapsuckers and snakes., [MASK]...  [frog, monster, spider, snake, lizard, demon, ...  {'frog': 0.5309367775917053, 'monster': 0.3040...  [animal, insect, monster, frog, spider, snake,...  {'animal': 0.44075757563114165, 'insect': 0.43...  [reptiles, things, snakes, animals, insects, m...  {'reptiles': 0.26613424707204103, 'things': 0....  
4  [A mako or bird is a [MASK]., A mako or human ...  [[MASK] such as makos and birds., [MASK] such ...  [human, chief, drum, bird, leader, drummer, pe...  {'human': 0.45522764325141907, 'chief': 0.3003...  [animal, drum, instrument, human, chief, offic...  {'animal': 0.3974847779609263, 'drum': 0.34020...  [animals, instruments, percussion, chiefs, peo...  {'animals': 0.42819555836419265, 'instruments'...  
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrlrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	 relation   	   anchor_wordnet_avg_path 	   anchor_wordnet_coverage 	   mask_type_id 
hline
  1 	 def_sap     	     0 	    60 	     80 	  27.9 	 IsA        	                      8.68 	                         1 	              1 
  2 	 lsp_sap     	    40 	    40 	     60 	  42   	 IsA        	                      8.68 	                         1 	              3 
  4 	 def_dap     	    40 	    40 	     40 	  40   	 IsA        	                      8.68 	                         1 	              2 
  5 	 lsp_dap     	    40 	    40 	     60 	  42   	 IsA        	                      8.68 	                         1 	              4 
hline
end{tabular}
save log/bert-large-uncased/lm_diagnostic_extended/sgpl/df_all_use_global_dap_True_anchor_type_Coordinate_remove_Y_PUNC_FULL_concate_or_single_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_wnp_True_cpt_False.LM_DIAGNOSTIC_EXTENDED.tsv
save log/bert-large-uncased/lm_diagnostic_extended/sgpl/exp_data_results_anchor_type_Coordinate_remove_Y_PUNC_FULL_concate_or_single_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_wnp_True_cpt_False.LM_DIAGNOSTIC_EXTENDED.csv
