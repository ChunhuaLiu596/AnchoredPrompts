debug: True
---------------------------------------- config ----------------------------------------
{'debug': True, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/clsb/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'add_wordnet_path_score': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors', 'anchor_col_sg': 'subj_anchors_sg', 'anchor_col_pl': 'subj_anchors_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'add_swow_score': False, 'swow_score_source': 'None'}
---------------------------------------- config ----------------------------------------
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/clsb/swow_rw//IsA.jsonl
#All Instances: 940
#Valid Instances: 940 in CLSB (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
	 step3: fill mask in dap anchors
  0%|          | 0/10 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 10%|█         | 1/10 [00:00<00:02,  4.32it/s] 20%|██        | 2/10 [00:00<00:01,  4.39it/s] 30%|███       | 3/10 [00:00<00:01,  4.37it/s] 40%|████      | 4/10 [00:00<00:01,  4.39it/s] 50%|█████     | 5/10 [00:01<00:01,  4.40it/s] 60%|██████    | 6/10 [00:01<00:00,  4.41it/s] 70%|███████   | 7/10 [00:01<00:00,  4.43it/s] 80%|████████  | 8/10 [00:01<00:00,  4.43it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.43it/s]100%|██████████| 10/10 [00:02<00:00,  4.44it/s]100%|██████████| 10/10 [00:02<00:00,  4.41it/s]
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:04,  2.23it/s] 20%|██        | 2/10 [00:00<00:03,  2.23it/s] 30%|███       | 3/10 [00:01<00:03,  2.27it/s] 40%|████      | 4/10 [00:01<00:02,  2.27it/s] 50%|█████     | 5/10 [00:02<00:02,  2.22it/s] 60%|██████    | 6/10 [00:02<00:01,  2.23it/s] 70%|███████   | 7/10 [00:03<00:01,  2.23it/s] 80%|████████  | 8/10 [00:03<00:00,  2.24it/s] 90%|█████████ | 9/10 [00:04<00:00,  2.24it/s]100%|██████████| 10/10 [00:04<00:00,  2.25it/s]100%|██████████| 10/10 [00:04<00:00,  2.24it/s]
    sub_label   obj_label relation              masked_sentences                                         sub_sister  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                   sub_label_sgpl                                  subj_anchors_swow                                       subj_anchors  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                             subj_anchors_swow_sg                               subj_anchors_swow_pl  \
0  alligators    [animal]      IsA  [An alligator is an [MASK].]  ['deerskin', 'calfskin', 'buff', 'fleece', 'cr...     2             3    alligator   alligators  [an alligator is a [MASK]., an alligator is a ...  [an alligator or [Z] is a [MASK]., an alligato...  [[MASK] such as alligators., [MASK], including...  [[MASK] such as alligators and [Z]., [MASK], i...  [such as alligators and [MASK]., such as allig...  alligators alligator alligators  [crocodile, reptile, reptile, cayman, amphibia...  ['snakes', 'turtles', 'frogs', 'lizards', 'sha...            1  [animal, insect, eel, alien, idiot, elephant, ...  {'animal': -5.75346447751135, 'insect': -10.19...  [fish, animal, turtle, crocodile, snake, lizar...  {'fish': -7.438471333835193, 'animal': -7.6710...  [reptile, animal, snake, thing, wildlife, fish...  {'reptiles': -5.7917639368590335, 'animals': -...  [crocodile, reptile, cayman, amphibian, iguana]   [crocodiles, reptile, cayman, amphibian, iguana]   
1  alligators  [predator]      IsA   [An alligator is a [MASK].]  ['deerskin', 'calfskin', 'buff', 'fleece', 'cr...     3             3    alligator   alligators  [an alligator is a [MASK]., an alligator is a ...  [an alligator or [Z] is a [MASK]., an alligato...  [[MASK] such as alligators., [MASK], including...  [[MASK] such as alligators and [Z]., [MASK], i...  [such as alligators and [MASK]., such as allig...  alligators alligator alligators  [crocodile, reptile, reptile, cayman, amphibia...  ['snakes', 'turtles', 'frogs', 'lizards', 'sha...            1  [fish, monster, snake, crocodile, turtle, huma...  {'fish': -7.292829009024019, 'monster': -8.504...  [fish, animal, turtle, crocodile, snake, lizar...  {'fish': -7.438471333835193, 'animal': -7.6710...  [reptile, animal, snake, thing, wildlife, fish...  {'reptiles': -5.7917639368590335, 'animals': -...  [crocodile, reptile, cayman, amphibian, iguana]   [crocodiles, reptile, cayman, amphibian, iguana]   
2  ambulances   [vehicle]      IsA   [An ambulance is a [MASK].]  ['loaner', 'racer', 'coupe', 'hatchback', 'wag...     4             3    ambulance   ambulances  [an ambulance is a [MASK]., an ambulance is a ...  [an ambulance or [Z] is a [MASK]., an ambulanc...  [[MASK] such as ambulances., [MASK], including...  [[MASK] such as ambulances and [Z]., [MASK], i...  [such as ambulances and [MASK]., such as ambul...  ambulances ambulance ambulances  [emergency, medic, hospital, firetruck, siren,...  ['police', 'buses', 'helicopters', 'cars', 'em...            1  [car, helicopter, hospital, vehicle, machine, ...  {'car': -8.0740543058224, 'helicopter': -8.913...  [vehicle, car, helicopter, machine, hospital, ...  {'vehicle': -8.574327708667136, 'car': -8.7382...  [vehicle, service, transportation, police, thi...  {'vehicles': -6.803935043970365, 'services': -...   [emergency, medic, hospital, firetruck, siren]  [emergencies, medics, hospitals, firetruck, si...   
3  ambulances       [van]      IsA   [An ambulance is a [MASK].]  ['loaner', 'racer', 'coupe', 'hatchback', 'wag...     5             3    ambulance   ambulances  [an ambulance is a [MASK]., an ambulance is a ...  [an ambulance or [Z] is a [MASK]., an ambulanc...  [[MASK] such as ambulances., [MASK], including...  [[MASK] such as ambulances and [Z]., [MASK], i...  [such as ambulances and [MASK]., such as ambul...  ambulances ambulance ambulances  [emergency, medic, hospital, firetruck, siren,...  ['police', 'buses', 'helicopters', 'cars', 'em...            1  [car, helicopter, hospital, vehicle, machine, ...  {'car': -8.0740543058224, 'helicopter': -8.913...  [vehicle, car, helicopter, machine, hospital, ...  {'vehicle': -8.574327708667136, 'car': -8.7382...  [vehicle, service, transportation, police, thi...  {'vehicles': -6.803935043970365, 'services': -...   [emergency, medic, hospital, firetruck, siren]  [emergencies, medics, hospitals, firetruck, si...   
4     anchors    [symbol]      IsA      [An anchor is a [MASK].]  ['linchpin', 'tenterhook', 'keystone', 'anchor...     6             3       anchor      anchors  [an anchor is a [MASK]., an anchor is a type o...  [an anchor or [Z] is a [MASK]., an anchor or [...  [[MASK] such as anchors., [MASK], including an...  [[MASK] such as anchors and [Z]., [MASK], incl...  [such as anchors and [MASK]., such as anchors ...           anchors anchor anchors  [nautical, sailboat, sail, boat, ship, seaman,...  ['reporters', 'ropes', 'pilots', 'boats', 'pro...            1  [ship, vessel, rope, boat, sail, device, tool,...  {'ship': -7.979022915831151, 'vessel': -8.4772...  [ship, vessel, boat, rope, device, sail, rock,...  {'ship': -8.670624330879761, 'vessel': -9.0290...  [equipment, news, newscast, accessory, device,...  {'equipment': -8.947564088570074, 'news': -9.3...           [nautical, sailboat, sail, boat, ship]           [nautical, sailboat, sail, boats, ships]   

                               subj_anchors_swow_all            subj_anchors_combined                  masked_sentences_with_subj_anchor                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [crocodile, reptile, cayman, amphibian, iguana...  alligators alligator alligators  [An alligator is an [MASK]., An alligator  or ...  [an alligator or a crocodile is a [MASK]., an ...  [[MASK] such as alligators and crocodiles., [M...  [fish, animal, lizard, mammal, turtle, crocodi...  {'fish': -7.52220497676009, 'animal': -7.74788...  [reptile, animal, snake, species, fish, wildli...  {'reptiles': -5.573738954963484, 'animals': -7...  
1  [crocodile, reptile, cayman, amphibian, iguana...  alligators alligator alligators  [An alligator is a [MASK]., An alligator  or c...  [an alligator or a crocodile is a [MASK]., an ...  [[MASK] such as alligators and crocodiles., [M...  [fish, animal, lizard, mammal, turtle, crocodi...  {'fish': -7.52220497676009, 'animal': -7.74788...  [reptile, animal, snake, species, fish, wildli...  {'reptiles': -5.573738954963484, 'animals': -7...  
2  [emergency, medic, hospital, firetruck, siren,...  ambulances ambulance ambulances  [An ambulance is a [MASK]., An ambulance  or e...  [an ambulance or an emergency is a [MASK]., an...  [[MASK] such as ambulances and emergencies., [...  [vehicle, siren, car, transport, service, heli...  {'vehicle': -7.0067552394729695, 'siren': -8.9...  [service, vehicle, thing, transport, transport...  {'services': -7.464326047425734, 'vehicles': -...  
3  [emergency, medic, hospital, firetruck, siren,...  ambulances ambulance ambulances  [An ambulance is a [MASK]., An ambulance  or e...  [an ambulance or an emergency is a [MASK]., an...  [[MASK] such as ambulances and emergencies., [...  [vehicle, siren, car, transport, service, heli...  {'vehicle': -7.0067552394729695, 'siren': -8.9...  [service, vehicle, thing, transport, transport...  {'services': -7.464326047425734, 'vehicles': -...  
4  [nautical, sailboat, sail, boat, ship, seaman,...           anchors anchor anchors  [An anchor is a [MASK]., An anchor  or nautica...  [an anchor or a nautical is a [MASK]., an anch...  [[MASK] such as anchors and nautical., [MASK] ...  [vessel, ship, boat, sail, device, structure, ...  {'vessel': -6.754942101698258, 'ship': -7.4905...  [ship, equipment, vessel, thing, object, item,...  {'ships': -8.546378904252814, 'equipment': -8....  
---------------------------------------- anchor evaluation ----------------------------------------
begin{tabular}{rlrrrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 	   anchor_wordnet_avg_path 	   anchor_wordnet_coverage 
hline
  0 	 subj_anchors_swow_sg  	    20 	    20 	     20 	     0 	                       9.9 	                       0.9 
  1 	 subj_anchors_swow_all 	    20 	    20 	     40 	     0 	                       9.9 	                       0.9 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   anchor_wordnet_avg_path 	   anchor_wordnet_coverage 	   mask_type_id 
hline
  1 	 def_sap     	    30 	    50 	     60 	  41.4 	                       9.9 	                       0.9 	              1 
  2 	 lsp_sap     	    30 	    50 	     70 	  42.5 	                       9.9 	                       0.9 	              3 
  3 	 def_dap     	    30 	    60 	     60 	  43.3 	                       9.9 	                       0.9 	              2 
  4 	 lsp_dap     	    20 	    50 	     70 	  37.2 	                       9.9 	                       0.9 	              4 
hline
end{tabular}
save log/bert-large-uncased/clsb/swow_rw/df_all_use_global_dap_True_anchor_type_Coordinate_remove_Y_PUNC_FULL_concate_or_single_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_wnp_False_cpt_False_anchor_source_SWOW_swow_score_source_None.CLSB.tsv
save log/bert-large-uncased/clsb/swow_rw/exp_data_results_anchor_type_Coordinate_remove_Y_PUNC_FULL_concate_or_single_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_wnp_False_cpt_False_anchor_source_SWOW_swow_score_source_None.CLSB.csv
