debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/BLESS/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'BLESS'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/BLESS//IsA.jsonl
#All Instances: 1337
#Valid Instances: 935 in BLESS (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                               def_dap                        subj_anchors_wordnet_sg
0    [a catfish or [Z] is a [MASK]., a catfish or [...                                         [carp]
1    [a musket or [Z] is a [MASK]., a musket or [Z]...                                [rifle, pistol]
2    [a lemon or [Z] is a [MASK]., a lemon or [Z] i...                                       [yellow]
3    [a turtle or [Z] is a [MASK]., a turtle or [Z]...              [snake, bird, fish, lizard, frog]
4    [a bag or [Z] is a [MASK]., a bag or [Z] is a ...                          [shoe, package, case]
..                                                 ...                                            ...
930  [a wrench or [Z] is a [MASK]., a wrench or [Z]...               [nail, maybe, chain, bolt, nuts]
931  [a squirrel or [Z] is a [MASK]., a squirrel or...                      [badger, bear, deer, fox]
932  [a cello or [Z] is a [MASK]., a cello or [Z] i...                [violin, guitar, string, piano]
933  [a glove or [Z] is a [MASK]., a glove or [Z] i...                                   [mask, belt]
934  [a stereo or [Z] is a [MASK]., a stereo or [Z]...  [speaker, amplifier, radio, computer, guitar]

[935 rows x 2 columns]
                                               lsp_dap                            subj_anchors_wordnet_pl
0    [[MASK] such as catfish and [Z]., [MASK], incl...                                             [carp]
1    [[MASK] such as muskets and [Z]., [MASK], incl...                                  [rifles, pistols]
2    [[MASK] such as lemon and [Z]., [MASK], includ...                                           [yellow]
3    [[MASK] such as turtles and [Z]., [MASK], incl...            [snakes, birds, fishes, lizards, frogs]
4    [[MASK] such as bags and [Z]., [MASK], includi...                           [shoes, packages, cases]
..                                                 ...                                                ...
930  [[MASK] such as wrenches and [Z]., [MASK], inc...                [nails, maybe, chains, bolts, nuts]
931  [[MASK] such as squirrel and [Z]., [MASK], inc...                          [badger, bear, deer, fox]
932  [[MASK] such as cellos and [Z]., [MASK], inclu...                [violins, guitars, strings, pianos]
933  [[MASK] such as glove and [Z]., [MASK], includ...                                      [mask, belts]
934  [[MASK] such as stereos and [Z]., [MASK], incl...  [speakers, amplifiers, radios, computers, guit...

[935 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/935 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 35%|███▍      | 325/935 [01:00<01:52,  5.41it/s] 35%|███▍      | 325/935 [01:20<01:52,  5.41it/s] 71%|███████   | 664/935 [02:00<00:48,  5.54it/s] 71%|███████   | 664/935 [02:20<00:48,  5.54it/s]100%|██████████| 935/935 [02:50<00:00,  5.48it/s]
  0%|          | 0/935 [00:00<?, ?it/s] 18%|█▊        | 171/935 [01:00<04:29,  2.83it/s] 18%|█▊        | 171/935 [01:19<04:29,  2.83it/s] 36%|███▌      | 334/935 [02:00<03:38,  2.75it/s] 36%|███▌      | 334/935 [02:19<03:38,  2.75it/s] 55%|█████▍    | 510/935 [03:01<02:30,  2.82it/s] 55%|█████▍    | 510/935 [03:19<02:30,  2.82it/s] 72%|███████▏  | 676/935 [04:01<01:32,  2.80it/s] 72%|███████▏  | 676/935 [04:19<01:32,  2.80it/s] 90%|████████▉ | 837/935 [05:01<00:35,  2.75it/s] 90%|████████▉ | 837/935 [05:19<00:35,  2.75it/s]100%|██████████| 935/935 [05:36<00:00,  2.78it/s]
  sub_label  obj_label relation                                   masked_sentences                                         sub_sister  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                               subj_anchors_wordnet                         subj_anchors_wordnet_score            subj_anchors_wordnet_sg                  subj_anchors_wordnet_pl  \
0   catfish     [fish]      IsA  [A catfish is a [MASK]., A catfish is an [MASK].]  [sandfish, wolffish, eel, greeneye, ghostfish,...     2             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish            1  [animal, fish, insect, eel, oyster, organism, ...  {'animal': -5.884246700948145, 'fish': -7.3868...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...                                             [carp]  {'bass': 0.39879070899703284, 'carp': 0.181602...                             [carp]                                   [carp]   
1   muskets  [firearm]      IsA    [A musket is a [MASK]., A musket is an [MASK].]  [flintlock, hackbut, harquebus, firelock, arqu...     3             2       musket      muskets  [a musket is a [MASK]., a musket is a type of ...  [a musket or [Z] is a [MASK]., a musket or [Z]...  [[MASK] such as muskets., [MASK], including mu...  [[MASK] such as muskets and [Z]., [MASK], incl...  [such as muskets and [MASK]., such as muskets ...   muskets musket muskets            1  [artillery, firearm, gun, cannon, arrow, instr...  {'artillery': -6.829809756901031, 'firearm': -...  [firearm, cannon, gun, weapon, rifle, pistol, ...  {'firearm': -5.349813407088699, 'cannon': -7.0...  [weapon, firearm, gun, artillery, arm, impleme...  {'weapons': -6.112329372878857, 'firearms': -6...                                  [rifles, pistols]  {'pistols': 0.24924550476399335, 'cannons': 0....                    [rifle, pistol]                        [rifles, pistols]   
2     lemon  [produce]      IsA      [A lemon is a [MASK]., A lemon is an [MASK].]  [lemanderin, grapefruit, good, insert, button,...     4             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon            1  [apple, orange, object, adjective, olive, almo...  {'apple': -6.533058511601689, 'orange': -7.425...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...                                           [yellow]  {'lime': 0.5027932287617163, 'orange': 0.15136...                           [yellow]                                 [yellow]   
3   turtles    [beast]      IsA    [A turtle is a [MASK]., A turtle is an [MASK].]         [turtleneck, pullover, slipover, cardigan]     6             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles            1  [animal, bird, fish, person, human, object, cr...  {'animal': -5.460504933765254, 'bird': -8.7831...  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....  [snakes, birds, fish, lizards, frogs, dragons,...  {'snakes': 0.3146660774946213, 'birds': 0.1580...  [snake, bird, fish, lizard, frog]  [snakes, birds, fishes, lizards, frogs]   
4      bags  [luggage]      IsA          [A bag is a [MASK]., A bag is an [MASK].]  [box, job, knocker, barrowful, measure, desser...     7             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags            1  [object, envelope, umbrella, item, accessory, ...  {'object': -7.057799467734983, 'envelope': -8....  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...                           [shoes, packages, cases]  {'boxes': 0.1638453546911478, 'yes': 0.0626923...              [shoe, package, case]                 [shoes, packages, cases]   

                            subj_anchors_wordnet_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0                                             [carp]  catfish catfish catfish           1  [a catfish or a carp is a [MASK]., a catfish o...  [[MASK] such as catfish and carp., [MASK], inc...  [fish, species, carp, freshwater, salmon, pred...  {'fish': -4.270898285899183, 'species': -13.02...  [fish, species, carp, fishing, animal, reptile...  {'fish': -4.8170564855226266, 'species': -8.71...  
1                                    [rifle, pistol]   muskets musket muskets           2  [a musket or a rifle is a [MASK]., a musket or...  [[MASK] such as muskets and rifles., [MASK] su...  [firearm, weapon, gun, pistol, cannon, handgun...  {'firearm': -4.768125888670261, 'weapon': -7.2...  [weapon, firearm, gun, arm, thing, weaponry, a...  {'weapons': -5.495475819229011, 'firearms': -6...  
2                                           [yellow]        lemon lemon lemon           1  [a lemon or a yellow is a [MASK]., a lemon or ...  [[MASK] such as lemon and yellow., [MASK], inc...  [fruit, flower, orange, wine, lime, drink, app...  {'fruit': -7.371728576620542, 'flower': -9.337...  [color, colour, orange, yellow, flower, variet...  {'colors': -5.956233236265533, 'colours': -8.1...  
3  [snake, bird, fish, lizard, frog, dragon, shar...   turtles turtle turtles          10  [a turtle or a snake is a [MASK]., a turtle or...  [[MASK] such as turtles and snakes., [MASK] su...  [animal, bird, fish, mammal, creature, lizard,...  {'animal': -7.5255446660385035, 'bird': -7.676...  [reptile, animal, wildlife, invertebrates, bir...  {'reptiles': -6.164623090730166, 'animals': -6...  
4                              [shoe, package, case]            bags bag bags           3  [a bag or a shoe is a [MASK]., a bag or a pack...  [[MASK] such as bags and shoes., [MASK] such a...  [container, luggage, shoe, backpack, clothing,...  {'container': -7.055212893260816, 'luggage': -...  [item, thing, luggage, object, good, belonging...  {'items': -7.653512465214155, 'things': -7.722...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	  36.1 	  60.2 	   60.2 	  45.3 
  1 	 subj_anchors_wordnet_all 	  36.1 	  60.2 	   62.7 	  45.6 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  16.4 	  32.7 	   42.4 	  23.6 	              1 
  2 	 lsp_sap     	  16.1 	  36.6 	   49.6 	  25.1 	              3 
  3 	 def_dap     	  17.1 	  36.9 	   47.6 	  25.5 	              2 
  4 	 lsp_dap     	  17.1 	  37.5 	   51.7 	  26   	              4 
hline
end{tabular}
save log/bert-large-uncased/hypernymsuite/BLESS/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.BLESS.tsv
save log/bert-large-uncased/hypernymsuite/BLESS/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.BLESS.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/lm_diagnostic_extended/singular/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'DIAG'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/lm_diagnostic_extended/singular//IsA.jsonl
#All Instances: 576
#Valid Instances: 576 in DIAG (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                               def_dap                       subj_anchors_wordnet_sg
0    [a graver or [Z] is a [MASK]., a graver or [Z]...      [shovel, digger, deeper, hammer, harder]
1    [a smallmouth or [Z] is a [MASK]., a smallmout...              [catfish, carp, bass, frog, eel]
2    [a pelican or [Z] is a [MASK]., a pelican or [...           [dolphin, whale, bird, heron, duck]
3    [a sapsucker or [Z] is a [MASK]., a sapsucker ...      [snake, spider, vampire, lizard, zombie]
4    [a mako or [Z] is a [MASK]., a mako or [Z] is ...               [human, dog, bird, man, animal]
..                                                 ...                                           ...
571  [a biplane or [Z] is a [MASK]., a biplane or [...  [fighter, bomber, scout, aircraft, airplane]
572  [a baobab or [Z] is a [MASK]., a baobab or [Z]...                                       [mango]
573  [an aircraft or [Z] is a [MASK]., an aircraft ...     [helicopter, ship, vehicle, boat, rocket]
574  [a gean or [Z] is a [MASK]., a gean or [Z] is ...                 [human, man, ge, gan, person]
575  [a luge or [Z] is a [MASK]., a luge or [Z] is ...          [knife, drills, needle, sword, john]

[576 rows x 2 columns]
                                               lsp_dap                            subj_anchors_wordnet_pl
0    [[MASK] such as graver and [Z]., [MASK], inclu...         [shovels, digger, deeper, hammers, harder]
1    [[MASK] such as smallmouths and [Z]., [MASK], ...               [catfish, carp, basses, frogs, eels]
2    [[MASK] such as pelican and [Z]., [MASK], incl...            [dolphin, whales, birds, herons, ducks]
3    [[MASK] such as sapsuckers and [Z]., [MASK], i...      [snakes, spiders, vampires, lizards, zombies]
4    [[MASK] such as mako and [Z]., [MASK], includi...                 [human, dogs, birds, men, animals]
..                                                 ...                                                ...
571  [[MASK] such as biplanes and [Z]., [MASK], inc...  [fighters, bombers, scouts, aircrafts, airplanes]
572  [[MASK] such as baobab and [Z]., [MASK], inclu...                                            [mango]
573  [[MASK] such as aircrafts and [Z]., [MASK], in...     [helicopters, ships, vehicles, boats, rockets]
574  [[MASK] such as gean and [Z]., [MASK], includi...                    [human, men, ge, gans, persons]
575  [[MASK] such as luges and [Z]., [MASK], includ...            [knives, drills, needles, swords, john]

[576 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/576 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 48%|████▊     | 275/576 [01:00<01:05,  4.58it/s] 48%|████▊     | 275/576 [01:20<01:05,  4.58it/s] 95%|█████████▍| 546/576 [02:00<00:06,  4.54it/s]100%|██████████| 576/576 [02:06<00:00,  4.55it/s]
  0%|          | 0/576 [00:00<?, ?it/s] 24%|██▍       | 140/576 [01:00<03:07,  2.32it/s] 24%|██▍       | 140/576 [01:13<03:07,  2.32it/s] 48%|████▊     | 276/576 [02:00<02:11,  2.29it/s] 48%|████▊     | 276/576 [02:13<02:11,  2.29it/s] 72%|███████▏  | 414/576 [03:00<01:10,  2.29it/s] 72%|███████▏  | 414/576 [03:13<01:10,  2.29it/s] 95%|█████████▍| 547/576 [04:00<00:12,  2.26it/s] 95%|█████████▍| 547/576 [04:13<00:12,  2.26it/s]100%|██████████| 576/576 [04:13<00:00,  2.27it/s]
              masked_sentences obj_label    sub_label sub_label_pl relation                                         sub_sister  uuid  sub_position sub_label_sg                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                      sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                               subj_anchors_wordnet                         subj_anchors_wordnet_score                   subj_anchors_wordnet_sg                        subj_anchors_wordnet_pl  \
0      [A graver is a [MASK].]    [tool]       graver       graver      IsA  [bevel, dibber, spreader, hammer, crank, float...     1             2       graver  [a graver is a [MASK]., a graver is a type of ...  [a graver or [Z] is a [MASK]., a graver or [Z]...  [[MASK] such as graver., [MASK], including gra...  [[MASK] such as graver and [Z]., [MASK], inclu...  [such as graver and [MASK]., such as graver or...                graver graver graver            1  [digger, shovel, tool, grave, coffin, person, ...  {'digger': -8.93893395450476, 'shovel': -8.996...  [shovel, tool, coffin, digger, grave, oven, to...  {'shovel': -7.8714093588212215, 'tool': -8.745...  [tool, story, poems, thing, book, works, digge...  {'tool': -8.670671149942246, 'stories': -9.270...  [shovel, digger, deeper, hammer, harder, john,...  {'shovel': 0.05705932136625051, 'digger': 0.05...  [shovel, digger, deeper, hammer, harder]     [shovels, digger, deeper, hammers, harder]   
1  [A smallmouth is a [MASK].]    [fish]  smallmouths  smallmouths      IsA                                       [largemouth]     2             2   smallmouth  [a smallmouth is a [MASK]., a smallmouth is a ...  [a smallmouth or [Z] is a [MASK]., a smallmout...  [[MASK] such as smallmouths., [MASK], includin...  [[MASK] such as smallmouths and [Z]., [MASK], ...  [such as smallmouths and [MASK]., such as smal...  smallmouths smallmouth smallmouths            1  [fish, catfish, salmon, shark, trout, swimmer,...  {'fish': -4.648060742066287, 'catfish': -6.835...  [fish, catfish, shark, swimmer, salmon, carp, ...  {'fish': -4.852696385096972, 'catfish': -6.629...  [fish, catfish, species, reptile, thing, preda...  {'fish': -6.019906277942945, 'catfish': -7.293...  [catfish, carp, bass, frogs, eels, cerambycida...  {'catfish': 0.6535254202105782, 'carp': 0.1299...          [catfish, carp, bass, frog, eel]           [catfish, carp, basses, frogs, eels]   
2     [A pelican is a [MASK].]    [bird]      pelican      pelican      IsA  [cormorant, snakebird, tropicbird, darter, anh...     3             2      pelican  [a pelican is a [MASK]., a pelican is a type o...  [a pelican or [Z] is a [MASK]., a pelican or [...  [[MASK] such as pelican., [MASK], including pe...  [[MASK] such as pelican and [Z]., [MASK], incl...  [such as pelican and [MASK]., such as pelican ...             pelican pelican pelican            1  [bird, parrot, penguin, dolphin, fish, dog, pi...  {'bird': -5.553109751033401, 'parrot': -7.7402...  [bird, parrot, dolphin, fish, dog, turtle, ani...  {'bird': -5.434608383702077, 'parrot': -8.5271...  [story, fish, dolphin, animal, bird, ship, poe...  {'stories': -8.638846115876778, 'fish': -8.785...  [dolphin, whale, bird, heron, duck, fish, peng...  {'dolphin': 0.07245542225427926, 'whale': 0.03...       [dolphin, whale, bird, heron, duck]        [dolphin, whales, birds, herons, ducks]   
3   [A sapsucker is a [MASK].]    [bird]   sapsuckers   sapsuckers      IsA    [wryneck, redhead, piculet, ivorybill, flicker]     4             2    sapsucker  [a sapsucker is a [MASK]., a sapsucker is a ty...  [a sapsucker or [Z] is a [MASK]., a sapsucker ...  [[MASK] such as sapsuckers., [MASK], including...  [[MASK] such as sapsuckers and [Z]., [MASK], i...  [such as sapsuckers and [MASK]., such as sapsu...     sapsuckers sapsucker sapsuckers            1  [snake, worm, spider, bug, lizard, predator, t...  {'snake': -7.64518889675958, 'worm': -8.365534...  [insect, snake, spider, lizard, animal, worm, ...  {'insect': -7.6130040846174385, 'snake': -8.26...  [snake, reptile, animal, insect, predator, cre...  {'snakes': -6.653929158976036, 'reptiles': -7....  [snakes, spiders, vampires, lizards, zombies, ...  {'snakes': 0.23924588378180156, 'spiders': 0.0...  [snake, spider, vampire, lizard, zombie]  [snakes, spiders, vampires, lizards, zombies]   
4        [A mako is a [MASK].]    [fish]         mako         mako      IsA                                        [porbeagle]     5             2         mako  [a mako is a [MASK]., a mako is a type of [MAS...  [a mako or [Z] is a [MASK]., a mako or [Z] is ...  [[MASK] such as mako., [MASK], including mako....  [[MASK] such as mako and [Z]., [MASK], includi...  [such as mako and [MASK]., such as mako or [MA...                      mako mako mako            1  [fish, canoe, drum, dog, boat, drummer, bird, ...  {'fish': -9.140592458399126, 'canoe': -9.49322...  [drum, fish, boat, canoe, bird, umbrella, flut...  {'drum': -8.934197447070298, 'fish': -9.539210...  [story, poems, fish, yes, artist, thing, peopl...  {'stories': -7.7291837518064845, 'poems': -9.2...  [human, dog, bird, man, animal, tuna, fish, wh...  {'human': 0.183084174990654, 'dog': 0.06033814...           [human, dog, bird, man, animal]             [human, dogs, birds, men, animals]   

                            subj_anchors_wordnet_all               subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [shovel, digger, deeper, hammer, harder, john,...                graver graver graver          10  [a graver or a shovel is a [MASK]., a graver o...  [[MASK] such as graver and shovels., [MASK] su...  [shovel, tool, digger, coffin, hammer, grave, ...  {'shovel': -7.267846614764853, 'tool': -7.6816...  [tool, thing, term, implement, yes, digger, sh...  {'tools': -7.066422549340426, 'things': -10.95...  
1  [catfish, carp, bass, frog, eel, cerambycidae,...  smallmouths smallmouth smallmouths          10  [a smallmouth or a catfish is a [MASK]., a sma...  [[MASK] such as smallmouths and catfish., [MAS...  [fish, catfish, mammal, frog, eel, toad, shark...  {'fish': -4.791638882592223, 'catfish': -8.175...  [fish, species, catfish, reptile, animal, bass...  {'fish': -6.020565090118574, 'species': -8.825...  
2  [dolphin, whale, bird, heron, duck, fish, peng...             pelican pelican pelican          10  [a pelican or a dolphin is a [MASK]., a pelica...  [[MASK] such as pelican and dolphin., [MASK] s...  [bird, dolphin, animal, fish, parrot, whale, b...  {'bird': -5.80281784715625, 'dolphin': -8.9196...  [bird, animal, species, fish, wildlife, mammal...  {'birds': -7.329673326729677, 'animals': -7.81...  
3  [snake, spider, vampire, lizard, zombie, beetl...     sapsuckers sapsucker sapsuckers          10  [a sapsucker or a snake is a [MASK]., a sapsuc...  [[MASK] such as sapsuckers and snakes., [MASK]...  [vampire, lizard, animal, insect, zombie, snak...  {'vampire': -8.462607530305084, 'lizard': -9.0...  [animal, reptile, snake, insect, demon, predat...  {'animals': -8.66370044212829, 'reptiles': -8....  
4  [human, dog, bird, man, animal, tuna, fish, wh...                      mako mako mako          10  [a mako or a human is a [MASK]., a mako or a d...  [[MASK] such as mako and human., [MASK] such a...  [animal, bird, person, dog, fish, human, creat...  {'animal': -7.602114597701367, 'bird': -8.3862...  [animal, thing, creature, dog, pet, bird, woma...  {'animals': -6.774860107420795, 'things': -9.9...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	  10.4 	    17 	     17 	  12.9 
  1 	 subj_anchors_wordnet_all 	  10.4 	    17 	     18 	  13   
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  32.5 	  56.6 	   66.8 	  42.6 	              1 
  2 	 lsp_sap     	  30.7 	  51.2 	   59.9 	  39   	              3 
  3 	 def_dap     	  35.4 	  58.9 	   68.8 	  45.7 	              2 
  4 	 lsp_dap     	  32.6 	  53.6 	   62.5 	  42.1 	              4 
hline
end{tabular}
save log/bert-large-uncased/lm_diagnostic_extended/singular/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.DIAG.tsv
save log/bert-large-uncased/lm_diagnostic_extended/singular/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.DIAG.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/clsb/singular/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'CLSB'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/clsb/singular//IsA.jsonl
#All Instances: 1310
#Valid Instances: 1079 in CLSB (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                 subj_anchors_wordnet_sg
0     [an aeroplane or [Z] is a [MASK]., an aeroplan...  [plane, airplane, balloon, helicopter]
1     [an alligator or [Z] is a [MASK]., an alligato...                         [snake, lizard]
2     [an alligator or [Z] is a [MASK]., an alligato...                         [snake, lizard]
3     [an ambulance or [Z] is a [MASK]., an ambulanc...                       [bus, truck, car]
4     [an ambulance or [Z] is a [MASK]., an ambulanc...                       [bus, truck, car]
...                                                 ...                                     ...
1074  [a yoghurt or [Z] is a [MASK]., a yoghurt or [...    [coffee, tea, beer, cheese, chicken]
1075  [a yoghurt or [Z] is a [MASK]., a yoghurt or [...    [coffee, tea, beer, cheese, chicken]
1076  [a yoyo or [Z] is a [MASK]., a yoyo or [Z] is ...          [yo, song, bird, dance, theme]
1077  [a zebra or [Z] is a [MASK]., a zebra or [Z] i...   [elephant, lion, horse, goat, cattle]
1078  [a zebra or [Z] is a [MASK]., a zebra or [Z] i...   [elephant, lion, horse, goat, cattle]

[1079 rows x 2 columns]
                                                lsp_dap                     subj_anchors_wordnet_pl
0     [[MASK] such as aeroplanes and [Z]., [MASK], i...  [planes, airplanes, balloons, helicopters]
1     [[MASK] such as alligators and [Z]., [MASK], i...                           [snakes, lizards]
2     [[MASK] such as alligators and [Z]., [MASK], i...                           [snakes, lizards]
3     [[MASK] such as ambulances and [Z]., [MASK], i...                       [buses, trucks, cars]
4     [[MASK] such as ambulances and [Z]., [MASK], i...                       [buses, trucks, cars]
...                                                 ...                                         ...
1074  [[MASK] such as yoghurt and [Z]., [MASK], incl...   [coffees, teas, beers, cheeses, chickens]
1075  [[MASK] such as yoghurt and [Z]., [MASK], incl...   [coffees, teas, beers, cheeses, chickens]
1076  [[MASK] such as yoyo and [Z]., [MASK], includi...           [yo, song, birds, dances, themes]
1077  [[MASK] such as zebras and [Z]., [MASK], inclu...   [elephants, lions, horses, goats, cattle]
1078  [[MASK] such as zebras and [Z]., [MASK], inclu...   [elephants, lions, horses, goats, cattle]

[1079 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/1079 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 27%|██▋       | 295/1079 [01:00<02:39,  4.90it/s] 27%|██▋       | 295/1079 [01:20<02:39,  4.90it/s] 56%|█████▌    | 599/1079 [02:00<01:36,  5.00it/s] 56%|█████▌    | 599/1079 [02:20<01:36,  5.00it/s] 82%|████████▏ | 881/1079 [03:00<00:40,  4.85it/s] 82%|████████▏ | 881/1079 [03:20<00:40,  4.85it/s]100%|██████████| 1079/1079 [03:40<00:00,  4.89it/s]
  0%|          | 0/1079 [00:00<?, ?it/s] 14%|█▎        | 147/1079 [01:00<06:20,  2.45it/s] 14%|█▎        | 147/1079 [01:19<06:20,  2.45it/s] 28%|██▊       | 298/1079 [02:00<05:14,  2.48it/s] 28%|██▊       | 298/1079 [02:19<05:14,  2.48it/s] 42%|████▏     | 458/1079 [03:00<04:02,  2.56it/s] 42%|████▏     | 458/1079 [03:19<04:02,  2.56it/s] 56%|█████▌    | 603/1079 [04:00<03:10,  2.50it/s] 56%|█████▌    | 603/1079 [04:19<03:10,  2.50it/s] 69%|██████▉   | 748/1079 [05:00<02:14,  2.47it/s] 69%|██████▉   | 748/1079 [05:19<02:14,  2.47it/s] 82%|████████▏ | 887/1079 [06:01<01:19,  2.41it/s] 82%|████████▏ | 887/1079 [06:19<01:19,  2.41it/s] 96%|█████████▌| 1035/1079 [07:01<00:18,  2.43it/s]100%|██████████| 1079/1079 [07:19<00:00,  2.46it/s]
    sub_label   obj_label              masked_sentences relation  weight feature_type obj_label_single                                         sub_sister  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                   sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                        subj_anchors_wordnet                         subj_anchors_wordnet_score                 subj_anchors_wordnet_sg                     subj_anchors_wordnet_pl  \
0  aeroplanes   [vehicle]   [An aeroplane is a [MASK].]      IsA       2    taxonomic          vehicle  [drone, airplane, whirlybird, ornithopter, war...     0             3    aeroplane   aeroplanes  [an aeroplane is a [MASK]., an aeroplane is a ...  [an aeroplane or [Z] is a [MASK]., an aeroplan...  [[MASK] such as aeroplanes., [MASK], including...  [[MASK] such as aeroplanes and [Z]., [MASK], i...  [such as aeroplanes and [MASK]., such as aerop...  aeroplanes aeroplane aeroplanes            1  [plane, biplane, glider, aircraft, helicopter,...  {'plane': -5.430296225218525, 'biplane': -7.54...  [aircraft, plane, airplane, glider, airship, b...  {'aircraft': -5.844922140009729, 'plane': -8.0...  [aircraft, thing, airplane, vehicle, plane, av...  {'aircraft': -5.754823951878233, 'things': -8....  [planes, airplanes, balloons, helicopters]  {'aircraft': 0.11055449159307913, 'helicopters...  [plane, airplane, balloon, helicopter]  [planes, airplanes, balloons, helicopters]   
1  alligators    [animal]  [An alligator is an [MASK].]      IsA      11    taxonomic           animal  [deerskin, calfskin, buff, fleece, crocodile, ...     2             3    alligator   alligators  [an alligator is a [MASK]., an alligator is a ...  [an alligator or [Z] is a [MASK]., an alligato...  [[MASK] such as alligators., [MASK], including...  [[MASK] such as alligators and [Z]., [MASK], i...  [such as alligators and [MASK]., such as allig...  alligators alligator alligators            1  [animal, insect, eel, alien, idiot, elephant, ...  {'animal': -5.75346447751135, 'insect': -10.19...  [fish, animal, turtle, crocodile, snake, lizar...  {'fish': -7.438471333835193, 'animal': -7.6710...  [reptile, animal, snake, thing, wildlife, fish...  {'reptiles': -5.7917639368590335, 'animals': -...                           [snakes, lizards]  {'snakes': 0.33330246941609815, 'turtles': 0.1...                         [snake, lizard]                           [snakes, lizards]   
2  alligators  [predator]   [An alligator is a [MASK].]      IsA       6    taxonomic         predator  [deerskin, calfskin, buff, fleece, crocodile, ...     4             3    alligator   alligators  [an alligator is a [MASK]., an alligator is a ...  [an alligator or [Z] is a [MASK]., an alligato...  [[MASK] such as alligators., [MASK], including...  [[MASK] such as alligators and [Z]., [MASK], i...  [such as alligators and [MASK]., such as allig...  alligators alligator alligators            1  [fish, monster, snake, crocodile, turtle, huma...  {'fish': -7.292829009024019, 'monster': -8.504...  [fish, animal, turtle, crocodile, snake, lizar...  {'fish': -7.438471333835193, 'animal': -7.6710...  [reptile, animal, snake, thing, wildlife, fish...  {'reptiles': -5.7917639368590335, 'animals': -...                           [snakes, lizards]  {'snakes': 0.33330246941609815, 'turtles': 0.1...                         [snake, lizard]                           [snakes, lizards]   
3  ambulances   [vehicle]   [An ambulance is a [MASK].]      IsA      21    taxonomic          vehicle  [loaner, racer, coupe, hatchback, wagon, cab, ...     6             3    ambulance   ambulances  [an ambulance is a [MASK]., an ambulance is a ...  [an ambulance or [Z] is a [MASK]., an ambulanc...  [[MASK] such as ambulances., [MASK], including...  [[MASK] such as ambulances and [Z]., [MASK], i...  [such as ambulances and [MASK]., such as ambul...  ambulances ambulance ambulances            1  [car, helicopter, hospital, vehicle, machine, ...  {'car': -8.0740543058224, 'helicopter': -8.913...  [vehicle, car, helicopter, machine, hospital, ...  {'vehicle': -8.574327708667136, 'car': -8.7382...  [vehicle, service, transportation, police, thi...  {'vehicles': -6.803935043970365, 'services': -...                       [buses, trucks, cars]  {'police': 0.28336215154691174, 'buses': 0.099...                       [bus, truck, car]                       [buses, trucks, cars]   
4  ambulances       [van]   [An ambulance is a [MASK].]      IsA       2    taxonomic              van  [loaner, racer, coupe, hatchback, wagon, cab, ...     7             3    ambulance   ambulances  [an ambulance is a [MASK]., an ambulance is a ...  [an ambulance or [Z] is a [MASK]., an ambulanc...  [[MASK] such as ambulances., [MASK], including...  [[MASK] such as ambulances and [Z]., [MASK], i...  [such as ambulances and [MASK]., such as ambul...  ambulances ambulance ambulances            1  [car, helicopter, hospital, vehicle, machine, ...  {'car': -8.0740543058224, 'helicopter': -8.913...  [vehicle, car, helicopter, machine, hospital, ...  {'vehicle': -8.574327708667136, 'car': -8.7382...  [vehicle, service, transportation, police, thi...  {'vehicles': -6.803935043970365, 'services': -...                       [buses, trucks, cars]  {'police': 0.28336215154691174, 'buses': 0.099...                       [bus, truck, car]                       [buses, trucks, cars]   

                 subj_anchors_wordnet_all            subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [plane, airplane, balloon, helicopter]  aeroplanes aeroplane aeroplanes           4  [an aeroplane or a plane is a [MASK]., an aero...  [[MASK] such as aeroplanes and planes., [MASK]...  [aircraft, plane, airplane, vehicle, helicopte...  {'aircraft': -6.189942467930687, 'plane': -8.8...  [aircraft, vehicle, airplane, thing, aviation,...  {'aircraft': -5.921075189198923, 'vehicles': -...  
1                         [snake, lizard]  alligators alligator alligators           2  [an alligator or a snake is a [MASK]., an alli...  [[MASK] such as alligators and snakes., [MASK]...  [lizard, fish, animal, snake, mammal, creature...  {'lizard': -7.5579983792325836, 'fish': -7.635...  [reptile, snake, animal, thing, wildlife, liza...  {'reptiles': -5.42864449623215, 'snakes': -7.9...  
2                         [snake, lizard]  alligators alligator alligators           2  [an alligator or a snake is a [MASK]., an alli...  [[MASK] such as alligators and snakes., [MASK]...  [lizard, fish, animal, snake, mammal, creature...  {'lizard': -7.5579983792325836, 'fish': -7.635...  [reptile, snake, animal, thing, wildlife, liza...  {'reptiles': -5.42864449623215, 'snakes': -7.9...  
3                       [bus, truck, car]  ambulances ambulance ambulances           3  [an ambulance or a bus is a [MASK]., an ambula...  [[MASK] such as ambulances and buses., [MASK] ...  [vehicle, car, transport, bus, automobile, tru...  {'vehicle': -6.067131964414974, 'car': -9.1736...  [vehicle, transportation, transport, thing, ca...  {'vehicles': -5.6249847176385135, 'transportat...  
4                       [bus, truck, car]  ambulances ambulance ambulances           3  [an ambulance or a bus is a [MASK]., an ambula...  [[MASK] such as ambulances and buses., [MASK] ...  [vehicle, car, transport, bus, automobile, tru...  {'vehicle': -6.067131964414974, 'car': -9.1736...  [vehicle, transportation, transport, thing, ca...  {'vehicles': -5.6249847176385135, 'transportat...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	  31.7 	  49.7 	   49.7 	  39.2 
  1 	 subj_anchors_wordnet_all 	  31.7 	  49.7 	   52.5 	  39.5 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  27.4 	  56.8 	   67.5 	  39.8 	              1 
  2 	 lsp_sap     	  26.1 	  52.5 	   63.9 	  37.5 	              3 
  3 	 def_dap     	  29.8 	  58.8 	   70.4 	  42.2 	              2 
  4 	 lsp_dap     	  27.8 	  57   	   67.3 	  40   	              4 
hline
end{tabular}
save log/bert-large-uncased/clsb/singular/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.CLSB.tsv
save log/bert-large-uncased/clsb/singular/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.CLSB.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/EVAL/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'EVAL'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/EVAL//IsA.jsonl
#All Instances: 957
#Valid Instances: 953 in EVAL (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                               def_dap                        subj_anchors_wordnet_sg
0    [an accident or [Z] is a [MASK]., an accident ...                             [injury, disaster]
1    [an accident or [Z] is a [MASK]., an accident ...                             [injury, disaster]
2    [an action or [Z] is a [MASK]., an action or [...     [word, feeling, thought, decision, person]
3    [an action or [Z] is a [MASK]., an action or [...     [word, feeling, thought, decision, person]
4    [an actor or [Z] is a [MASK]., an actor or [Z]...  [director, musician, actress, singer, dancer]
..                                                 ...                                            ...
948  [a world or [Z] is a [MASK]., a world or [Z] i...         [human, dimension, people, maybe, yes]
949  [a world or [Z] is a [MASK]., a world or [Z] i...         [human, dimension, people, maybe, yes]
950  [a worm or [Z] is a [MASK]., a worm or [Z] is ...                   [spider, insect, bug, snail]
951  [a writer or [Z] is a [MASK]., a writer or [Z]...        [artist, poet, editor, actor, musician]
952  [a yard or [Z] is a [MASK]., a yard or [Z] is ...                                       [garden]

[953 rows x 2 columns]
                                               lsp_dap                            subj_anchors_wordnet_pl
0    [[MASK] such as accidents and [Z]., [MASK], in...                              [injuries, disasters]
1    [[MASK] such as accidents and [Z]., [MASK], in...                              [injuries, disasters]
2    [[MASK] such as actions and [Z]., [MASK], incl...    [words, feelings, thoughts, decisions, persons]
3    [[MASK] such as actions and [Z]., [MASK], incl...    [words, feelings, thoughts, decisions, persons]
4    [[MASK] such as actors and [Z]., [MASK], inclu...  [directors, musicians, actresses, singers, dan...
..                                                 ...                                                ...
948  [[MASK] such as worlds and [Z]., [MASK], inclu...            [human, dimensions, people, maybe, yes]
949  [[MASK] such as worlds and [Z]., [MASK], inclu...            [human, dimensions, people, maybe, yes]
950  [[MASK] such as worms and [Z]., [MASK], includ...                   [spiders, insects, bugs, snails]
951  [[MASK] such as writers and [Z]., [MASK], incl...       [artists, poets, editors, actors, musicians]
952  [[MASK] such as yard and [Z]., [MASK], includi...                                          [gardens]

[953 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/953 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 29%|██▊       | 273/953 [01:00<02:30,  4.53it/s] 29%|██▊       | 273/953 [01:20<02:30,  4.53it/s] 57%|█████▋    | 540/953 [02:00<01:32,  4.48it/s] 57%|█████▋    | 540/953 [02:20<01:32,  4.48it/s] 85%|████████▍ | 810/953 [03:00<00:31,  4.48it/s] 85%|████████▍ | 810/953 [03:20<00:31,  4.48it/s]100%|██████████| 953/953 [03:30<00:00,  4.54it/s]
  0%|          | 0/953 [00:00<?, ?it/s] 15%|█▍        | 140/953 [01:00<05:48,  2.33it/s] 15%|█▍        | 140/953 [01:19<05:48,  2.33it/s] 29%|██▉       | 275/953 [02:00<04:58,  2.27it/s] 29%|██▉       | 275/953 [02:19<04:58,  2.27it/s] 43%|████▎     | 407/953 [03:00<04:04,  2.24it/s] 43%|████▎     | 407/953 [03:19<04:04,  2.24it/s] 57%|█████▋    | 546/953 [04:01<03:00,  2.26it/s] 57%|█████▋    | 546/953 [04:19<03:00,  2.26it/s] 72%|███████▏  | 685/953 [05:01<01:57,  2.28it/s] 72%|███████▏  | 685/953 [05:19<01:57,  2.28it/s] 86%|████████▌ | 818/953 [06:01<00:59,  2.26it/s] 86%|████████▌ | 818/953 [06:19<00:59,  2.26it/s]100%|██████████| 953/953 [06:56<00:00,  2.29it/s]
   sub_label  obj_label relation                                   masked_sentences                                         sub_sister  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                               subj_anchors_wordnet                         subj_anchors_wordnet_score                        subj_anchors_wordnet_sg                            subj_anchors_wordnet_pl  \
0  accidents    [error]      IsA  [An accident is a [MASK]., An accident is an [...  [gravy, convergence, reverse, flash, interrupt...     0             3     accident    accidents  [an accident is a [MASK]., an accident is a ty...  [an accident or [Z] is a [MASK]., an accident ...  [[MASK] such as accidents., [MASK], including ...  [[MASK] such as accidents and [Z]., [MASK], in...  [such as accidents and [MASK]., such as accide...  accidents accident accidents            1  [mistake, disaster, failure, tragedy, crime, c...  {'mistake': -7.604061857774812, 'disaster': -8...  [tragedy, disaster, mistake, catastrophe, crim...  {'tragedy': -8.648991036579575, 'disaster': -8...  [incident, injury, thing, event, causes, disas...  {'incidents': -8.381302205838045, 'injuries': ...                              [injuries, disasters]  {'incidents': 0.15264960266649724, 'yes': 0.05...                             [injury, disaster]                              [injuries, disasters]   
1  accidents  [mistake]      IsA  [An accident is a [MASK]., An accident is an [...  [gravy, convergence, reverse, flash, interrupt...     1             3     accident    accidents  [an accident is a [MASK]., an accident is a ty...  [an accident or [Z] is a [MASK]., an accident ...  [[MASK] such as accidents., [MASK], including ...  [[MASK] such as accidents and [Z]., [MASK], in...  [such as accidents and [MASK]., such as accide...  accidents accident accidents            1  [mistake, disaster, failure, tragedy, crime, c...  {'mistake': -7.604061857774812, 'disaster': -8...  [tragedy, disaster, mistake, catastrophe, crim...  {'tragedy': -8.648991036579575, 'disaster': -8...  [incident, injury, thing, event, causes, disas...  {'incidents': -8.381302205838045, 'injuries': ...                              [injuries, disasters]  {'incidents': 0.15264960266649724, 'yes': 0.05...                             [injury, disaster]                              [injuries, disasters]   
2    actions    [event]      IsA  [An action is a [MASK]., An action is an [MASK].]  [job, ironing, omnipotence, degeneration, inte...     2             3       action      actions  [an action is a [MASK]., an action is a type o...  [an action or [Z] is a [MASK]., an action or [...  [[MASK] such as actions., [MASK], including ac...  [[MASK] such as actions and [Z]., [MASK], incl...  [such as actions and [MASK]., such as actions ...        actions action actions            1  [act, idea, statement, process, reaction, cons...  {'act': -8.938543281627771, 'idea': -9.7474822...  [behavior, movement, process, reaction, decisi...  {'behavior': -9.292473658582107, 'movement': -...  [thing, act, emotion, thought, event, feeling,...  {'things': -8.395079900742743, 'acts': -9.6160...  [words, feelings, thoughts, decisions, persons...  {'words': 0.05404121623459188, 'feelings': 0.0...     [word, feeling, thought, decision, person]    [words, feelings, thoughts, decisions, persons]   
3    actions     [work]      IsA  [An action is a [MASK]., An action is an [MASK].]  [job, ironing, omnipotence, degeneration, inte...     3             3       action      actions  [an action is a [MASK]., an action is a type o...  [an action or [Z] is a [MASK]., an action or [...  [[MASK] such as actions., [MASK], including ac...  [[MASK] such as actions and [Z]., [MASK], incl...  [such as actions and [MASK]., such as actions ...        actions action actions            1  [act, idea, statement, process, reaction, cons...  {'act': -8.938543281627771, 'idea': -9.7474822...  [behavior, movement, process, reaction, decisi...  {'behavior': -9.292473658582107, 'movement': -...  [thing, act, emotion, thought, event, feeling,...  {'things': -8.395079900742743, 'acts': -9.6160...  [words, feelings, thoughts, decisions, persons...  {'words': 0.05404121623459188, 'feelings': 0.0...     [word, feeling, thought, decision, person]    [words, feelings, thoughts, decisions, persons]   
4     actors   [person]      IsA    [An actor is a [MASK]., An actor is an [MASK].]  [quester, white, signer, knocker, granter, nam...     4             3        actor       actors  [an actor is a [MASK]., an actor is a type of ...  [an actor or [Z] is a [MASK]., an actor or [Z]...  [[MASK] such as actors., [MASK], including act...  [[MASK] such as actors and [Z]., [MASK], inclu...  [such as actors and [MASK]., such as actors or...           actors actor actors            1  [performer, singer, musician, writer, person, ...  {'performer': -7.68316421097708, 'singer': -8....  [person, performer, musician, writer, singer, ...  {'person': -7.954193489394565, 'performer': -8...  [artist, performer, people, professional, cele...  {'artists': -7.7648846420167414, 'performers':...  [directors, musicians, actresses, singers, dan...  {'directors': 0.1862686418674209, 'musicians':...  [director, musician, actress, singer, dancer]  [directors, musicians, actresses, singers, dan...   

                            subj_anchors_wordnet_all         subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0                                 [injury, disaster]  accidents accident accidents           2  [an accident or an injury is a [MASK]., an acc...  [[MASK] such as accidents and injuries., [MASK...  [disaster, injury, tragedy, catastrophe, crime...  {'disaster': -8.13311631784059, 'injury': -8.6...  [incident, thing, event, emergency, matter, in...  {'incidents': -8.49283761475287, 'things': -9....  
1                                 [injury, disaster]  accidents accident accidents           2  [an accident or an injury is a [MASK]., an acc...  [[MASK] such as accidents and injuries., [MASK...  [disaster, injury, tragedy, catastrophe, crime...  {'disaster': -8.13311631784059, 'injury': -8.6...  [incident, thing, event, emergency, matter, in...  {'incidents': -8.49283761475287, 'things': -9....  
2  [word, feeling, thought, decision, person, emo...        actions action actions          10  [an action or a word is a [MASK]., an action o...  [[MASK] such as actions and words., [MASK] suc...  [decision, thing, person, statement, concept, ...  {'decision': -9.522891327148402, 'thing': -10....  [thing, emotion, thought, feeling, concept, pe...  {'things': -7.700017933528187, 'emotions': -9....  
3  [word, feeling, thought, decision, person, emo...        actions action actions          10  [an action or a word is a [MASK]., an action o...  [[MASK] such as actions and words., [MASK] suc...  [decision, thing, person, statement, concept, ...  {'decision': -9.522891327148402, 'thing': -10....  [thing, emotion, thought, feeling, concept, pe...  {'things': -7.700017933528187, 'emotions': -9....  
4  [director, musician, actress, singer, dancer, ...           actors actor actors          10  [an actor or a director is a [MASK]., an actor...  [[MASK] such as actors and directors., [MASK] ...  [person, musician, performer, artist, singer, ...  {'person': -6.413796532357328, 'musician': -7....  [artist, performer, professional, people, musi...  {'artists': -7.0007960958948825, 'performers':...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	  30.8 	  56.6 	   56.6 	  40.6 
  1 	 subj_anchors_wordnet_all 	  30.8 	  56.6 	   66.9 	  42   
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  14.8 	  36   	   46.7 	  24   	              1 
  2 	 lsp_sap     	   7.8 	  27.3 	   38.1 	  16   	              3 
  3 	 def_dap     	  14.1 	  34.4 	   44.3 	  22.7 	              2 
  4 	 lsp_dap     	   8   	  24.6 	   37.3 	  15.5 	              4 
hline
end{tabular}
save log/bert-large-uncased/hypernymsuite/EVAL/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.EVAL.tsv
save log/bert-large-uncased/hypernymsuite/EVAL/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.EVAL.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/LEDS/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'LEDS'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/LEDS//IsA.jsonl
#All Instances: 1385
#Valid Instances: 1262 in LEDS (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                            subj_anchors_wordnet_sg
0     [an etching or [Z] is a [MASK]., an etching or...                                        [engraving]
1     [a decrease or [Z] is a [MASK]., a decrease or...  [increases, respectively, vs, addition, increase]
2     [a dinghy or [Z] is a [MASK]., a dinghy or [Z]...                                            [ferry]
3     [a tie or [Z] is a [MASK]., a tie or [Z] is a ...                                     [blazer, suit]
4     [a batsman or [Z] is a [MASK]., a batsman or [...        [player, captain, opener, manager, bowling]
...                                                 ...                                                ...
1257  [a typography or [Z] is a [MASK]., a typograph...               [poster, map, photograph, book, etc]
1258  [a tench or [Z] is a [MASK]., a tench or [Z] i...                  [horse, wine, spain, poems, bell]
1259  [an army or [Z] is a [MASK]., an army or [Z] i...                                         [division]
1260  [a fresco or [Z] is a [MASK]., a fresco or [Z]...       [painting, sculpture, mural, church, statue]
1261  [a hare or [Z] is a [MASK]., a hare or [Z] is ...                  [hounds, fox, deer, rabbit, john]

[1262 rows x 2 columns]
                                                lsp_dap                            subj_anchors_wordnet_pl
0     [[MASK] such as etching and [Z]., [MASK], incl...                                        [engraving]
1     [[MASK] such as decreases and [Z]., [MASK], in...  [increases, respectively, vs, additions, incre...
2     [[MASK] such as dinghies and [Z]., [MASK], inc...                                          [ferries]
3     [[MASK] such as tie and [Z]., [MASK], includin...                                   [blazers, suits]
4     [[MASK] such as batsmen and [Z]., [MASK], incl...    [players, captains, openers, managers, bowling]
...                                                 ...                                                ...
1257  [[MASK] such as typographies and [Z]., [MASK],...           [posters, maps, photographs, books, etc]
1258  [[MASK] such as tenches and [Z]., [MASK], incl...               [horses, wines, spain, poems, bells]
1259  [[MASK] such as armies and [Z]., [MASK], inclu...                                        [divisions]
1260  [[MASK] such as frescoes and [Z]., [MASK], inc...  [paintings, sculptures, murals, churches, stat...
1261  [[MASK] such as hare and [Z]., [MASK], includi...                 [hounds, fox, deer, rabbits, john]

[1262 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/1262 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 23%|██▎       | 295/1262 [01:00<03:17,  4.90it/s] 23%|██▎       | 295/1262 [01:20<03:17,  4.90it/s] 47%|████▋     | 590/1262 [02:00<02:16,  4.91it/s] 47%|████▋     | 590/1262 [02:20<02:16,  4.91it/s] 71%|███████   | 894/1262 [03:00<01:14,  4.97it/s] 71%|███████   | 894/1262 [03:20<01:14,  4.97it/s] 94%|█████████▍| 1191/1262 [04:00<00:14,  4.96it/s]100%|██████████| 1262/1262 [04:14<00:00,  4.95it/s]
  0%|          | 0/1262 [00:00<?, ?it/s] 12%|█▏        | 155/1262 [01:00<07:11,  2.56it/s] 12%|█▏        | 155/1262 [01:15<07:11,  2.56it/s] 23%|██▎       | 296/1262 [02:00<06:36,  2.43it/s] 23%|██▎       | 296/1262 [02:15<06:36,  2.43it/s] 36%|███▌      | 450/1262 [03:00<05:25,  2.49it/s] 36%|███▌      | 450/1262 [03:15<05:25,  2.49it/s] 48%|████▊     | 610/1262 [04:01<04:15,  2.56it/s] 48%|████▊     | 610/1262 [04:15<04:15,  2.56it/s] 61%|██████    | 766/1262 [05:01<03:12,  2.57it/s] 61%|██████    | 766/1262 [05:15<03:12,  2.57it/s] 73%|███████▎  | 917/1262 [06:01<02:15,  2.55it/s] 73%|███████▎  | 917/1262 [06:15<02:15,  2.55it/s] 85%|████████▍ | 1069/1262 [07:01<01:15,  2.54it/s] 85%|████████▍ | 1069/1262 [07:15<01:15,  2.54it/s] 96%|█████████▌| 1213/1262 [08:01<00:19,  2.49it/s] 96%|█████████▌| 1213/1262 [08:15<00:19,  2.49it/s]100%|██████████| 1262/1262 [08:20<00:00,  2.52it/s]
   sub_label   obj_label relation                                   masked_sentences                                         sub_sister  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                               subj_anchors_wordnet                         subj_anchors_wordnet_score                            subj_anchors_wordnet_sg                            subj_anchors_wordnet_pl  \
0    etching       [art]      IsA  [An etching is a [MASK]., An etching is an [MA...  [halftone, serigraphy, woodcut, lithography, p...     0             3      etching      etching  [an etching is a [MASK]., an etching is a type...  [an etching or [Z] is a [MASK]., an etching or...  [[MASK] such as etching., [MASK], including et...  [[MASK] such as etching and [Z]., [MASK], incl...  [such as etching and [MASK]., such as etching ...       etching etching etching            1  [drawing, illustration, painting, engraving, p...  {'drawing': -6.798399279520061, 'illustration'...  [drawing, painting, engraving, print, illustra...  {'drawing': -6.167860487330729, 'painting': -6...  [thing, technique, art, drawing, painting, wor...  {'things': -7.88263134598992, 'techniques': -8...                                        [engraving]  {'engraving': 0.4049466320059516, 'painting': ...                                        [engraving]                                        [engraving]   
1  decreases    [change]      IsA  [A decrease is a [MASK]., A decrease is an [MA...  [birth, nascency, defining, dealignment, degen...     2             2     decrease    decreases  [a decrease is a [MASK]., a decrease is a type...  [a decrease or [Z] is a [MASK]., a decrease or...  [[MASK] such as decreases., [MASK], including ...  [[MASK] such as decreases and [Z]., [MASK], in...  [such as decreases and [MASK]., such as decrea...  decreases decrease decreases            1  [increase, gain, loss, improvement, maximum, r...  {'increase': -6.402507361409926, 'gain': -6.77...  [increase, gain, loss, change, reduction, expa...  {'increase': -7.421413369852303, 'gain': -8.46...  [causes, increases, change, factor, means, eff...  {'causes': -8.435093703711, 'increases': -8.43...  [increases, respectively, vs, additions, incre...  {'increases': 0.695974740115079, 'respectively...  [increases, respectively, vs, addition, increase]  [increases, respectively, vs, additions, incre...   
2   dinghies      [boat]      IsA    [A dinghy is a [MASK]., A dinghy is an [MASK].]  [canoe, cockleshell, gig, rowboat, dory, yawl,...     3             2       dinghy     dinghies  [a dinghy is a [MASK]., a dinghy is a type of ...  [a dinghy or [Z] is a [MASK]., a dinghy or [Z]...  [[MASK] such as dinghies., [MASK], including d...  [[MASK] such as dinghies and [Z]., [MASK], inc...  [such as dinghies and [MASK]., such as dinghie...      dinghies dinghy dinghies            1  [aircraft, airship, yacht, boat, automobile, e...  {'aircraft': -6.9738131185113055, 'airship': -...  [boat, yacht, vessel, sailing, sail, ship, cra...  {'boat': -5.155298464348918, 'yacht': -5.60234...  [boat, thing, ship, sailing, vessel, yacht, cr...  {'boats': -4.961173063122545, 'things': -9.064...                                          [ferries]  {'boats': 0.44899788905273785, 'submarines': 0...                                            [ferry]                                          [ferries]   
3        tie  [clothing]      IsA          [A tie is a [MASK]., A tie is an [MASK].]  [lanyard, gusset, eyelet, chenille, balk, stri...     5             2          tie          tie  [a tie is a [MASK]., a tie is a type of [MASK]...  [a tie or [Z] is a [MASK]., a tie or [Z] is a ...  [[MASK] such as tie., [MASK], including tie., ...  [[MASK] such as tie and [Z]., [MASK], includin...  [such as tie and [MASK]., such as tie or [MASK...                   tie tie tie            1  [object, knot, order, anchor, agreement, arrow...  {'object': -8.206908354643717, 'knot': -9.0139...  [knot, shirt, belt, ribbon, jacket, clothing, ...  {'knot': -9.035804536093991, 'shirt': -10.4270...  [yes, thing, brand, yeah, tie, wins, problem, ...  {'yes': -8.920535460424064, 'things': -8.96685...                                   [blazers, suits]  {'loss': 0.3967977449297905, 'suit': 0.1319183...                                     [blazer, suit]                                   [blazers, suits]   
4    batsmen   [athlete]      IsA  [A batsman is a [MASK]., A batsman is an [MASK].]  [hurler, hitter, batter, pitcher, fielder, twi...     6             2      batsman      batsmen  [a batsman is a [MASK]., a batsman is a type o...  [a batsman or [Z] is a [MASK]., a batsman or [...  [[MASK] such as batsmen., [MASK], including ba...  [[MASK] such as batsmen and [Z]., [MASK], incl...  [such as batsmen and [MASK]., such as batsmen ...       batsmen batsman batsmen            1  [bowler, opener, outfielder, catcher, batter, ...  {'bowler': -6.232246258775115, 'opener': -7.88...  [cricketer, footballer, player, bowler, athlet...  {'cricketer': -7.3063472463640675, 'footballer...  [player, thing, batting, people, man, team, po...  {'players': -5.269524161883701, 'things': -11....  [players, captains, opener, managers, bowling,...  {'players': 0.16115271571007642, 'captains': 0...        [player, captain, opener, manager, bowling]    [players, captains, openers, managers, bowling]   

                            subj_anchors_wordnet_all         subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0                                        [engraving]       etching etching etching           1  [an etching or an engraving is a [MASK]., an e...  [[MASK] such as etching and engraving., [MASK]...  [drawing, engraving, painting, print, artwork,...  {'drawing': -7.178663398525997, 'engraving': -...  [art, technique, drawing, works, thing, work, ...  {'art': -7.497529597067324, 'arts': -7.8332048...  
1  [increases, respectively, vs, addition, increa...  decreases decrease decreases          10  [a decrease or an increases is a [MASK]., a de...  [[MASK] such as decreases and increases., [MAS...  [increase, change, reduction, loss, constant, ...  {'increase': -7.7426843384560735, 'change': -7...  [thing, change, factor, variable, increases, f...  {'things': -8.71067583831256, 'changes': -9.76...  
2                                            [ferry]      dinghies dinghy dinghies           1  [a dinghy or a ferry is a [MASK]., a dinghy or...  [[MASK] such as dinghies and ferries., [MASK],...  [boat, vessel, ship, yacht, craft, warship, fe...  {'boat': -4.898096749701918, 'vessel': -6.6590...  [boat, vessel, ship, craft, thing, ferry, tran...  {'boats': -5.310532794643032, 'vessels': -7.61...  
3                                     [blazer, suit]                   tie tie tie           2  [a tie or a blazer is a [MASK]., a tie or a su...  [[MASK] such as tie and blazers., [MASK] such ...  [jacket, clothing, dress, suit, coat, garment,...  {'jacket': -7.906199311635896, 'clothing': -8....  [clothing, clothes, accessory, suit, wear, thi...  {'clothing': -7.7404671587713025, 'clothes': -...  
4  [player, captain, opener, manager, bowling, in...       batsmen batsman batsmen          10  [a batsman or a player is a [MASK]., a batsman...  [[MASK] such as batsmen and players., [MASK] s...  [player, cricketer, footballer, person, athlet...  {'player': -7.470582839281936, 'cricketer': -8...  [player, sport, position, official, people, te...  {'players': -6.187006638307553, 'sports': -10....  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	    27 	  45.5 	   45.5 	  34   
  1 	 subj_anchors_wordnet_all 	    27 	  45.5 	   50.3 	  34.6 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  20.6 	  49   	   60.1 	  32.6 	              1 
  2 	 lsp_sap     	  20   	  46.4 	   57.7 	  31.1 	              3 
  3 	 def_dap     	  23.4 	  52.5 	   66.2 	  36.1 	              2 
  4 	 lsp_dap     	  21.9 	  48.6 	   60.1 	  33.6 	              4 
hline
end{tabular}
save log/bert-large-uncased/hypernymsuite/LEDS/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.LEDS.tsv
save log/bert-large-uncased/hypernymsuite/LEDS/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.LEDS.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/SHWARTZ/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': True, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_wordnet', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': False, 'anchor_source': 'WordNet', 'only_swow_anchor': False, 'add_swow_score': False, 'swow_score_source': 'None', 'add_swow_filter': False, 'dataset': 'SHWARTZ'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/SHWARTZ//IsA.jsonl
#All Instances: 12994
#Valid Instances: 12724 in SHWARTZ (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                 def_dap                            subj_anchors_wordnet_sg
0      [a golo or [Z] is a [MASK]., a golo or [Z] is ...                  [human, bird, dog, animal, italy]
1      [a kerrobert or [Z] is a [MASK]., a kerrobert ...           [human, germany, france, robert, person]
2      [a geometria or [Z] is a [MASK]., a geometria ...  [geometry, sphere, mathematics, physics, astro...
3      [an evaporation or [Z] is a [MASK]., an evapor...    [precipitation, convection, water, rain, vapor]
4      [a bonehead or [Z] is a [MASK]., a bonehead or...           [woman, apparently, idiot, human, maybe]
...                                                  ...                                                ...
12719  [a fresco or [Z] is a [MASK]., a fresco or [Z]...       [painting, sculpture, mural, church, statue]
12720  [a mongrel or [Z] is a [MASK]., a mongrel or [...                                             [wolf]
12721  [a dimension or [Z] is a [MASK]., a dimension ...  [physical, angles, material, shapes, measurement]
12722  [a tronador or [Z] is a [MASK]., a tronador or...           [thief, human, mexico, bandit, criminal]
12723  [a repulsion or [Z] is a [MASK]., a repulsion ...                             [attraction, reaction]

[12724 rows x 2 columns]
                                                 lsp_dap                            subj_anchors_wordnet_pl
0      [[MASK] such as golo and [Z]., [MASK], includi...               [human, birds, dogs, animals, italy]
1      [[MASK] such as kerrobert and [Z]., [MASK], in...          [human, germany, france, robert, persons]
2      [[MASK] such as geometria and [Z]., [MASK], in...  [geometries, spheres, mathematics, physics, as...
3      [[MASK] such as evaporations and [Z]., [MASK],...  [precipitations, convection, waters, rains, va...
4      [[MASK] such as boneheads and [Z]., [MASK], in...          [women, apparently, idiots, human, maybe]
...                                                  ...                                                ...
12719  [[MASK] such as frescoes and [Z]., [MASK], inc...  [paintings, sculptures, murals, churches, stat...
12720  [[MASK] such as mongrel and [Z]., [MASK], incl...                                             [wolf]
12721  [[MASK] such as dimensions and [Z]., [MASK], i...  [physical, angles, materials, shapes, measurem...
12722  [[MASK] such as tronadors and [Z]., [MASK], in...       [thieves, human, mexico, bandits, criminals]
12723  [[MASK] such as repulsions and [Z]., [MASK], i...                           [attractions, reactions]

[12724 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/12724 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
  2%|▏         | 243/12724 [01:00<51:29,  4.04it/s]  2%|▏         | 243/12724 [01:20<51:29,  4.04it/s]  4%|▍         | 495/12724 [02:00<49:22,  4.13it/s]  4%|▍         | 495/12724 [02:20<49:22,  4.13it/s]  6%|▌         | 748/12724 [03:00<47:58,  4.16it/s]  6%|▌         | 748/12724 [03:20<47:58,  4.16it/s]  8%|▊         | 998/12724 [04:00<46:58,  4.16it/s]  8%|▊         | 998/12724 [04:20<46:58,  4.16it/s] 10%|▉         | 1246/12724 [05:00<46:08,  4.15it/s] 10%|▉         | 1246/12724 [05:20<46:08,  4.15it/s] 12%|█▏        | 1494/12724 [06:00<45:13,  4.14it/s] 12%|█▏        | 1494/12724 [06:20<45:13,  4.14it/s] 14%|█▎        | 1743/12724 [07:01<44:13,  4.14it/s] 14%|█▎        | 1743/12724 [07:20<44:13,  4.14it/s] 16%|█▌        | 1990/12724 [08:01<43:21,  4.13it/s] 16%|█▌        | 1990/12724 [08:20<43:21,  4.13it/s] 18%|█▊        | 2230/12724 [09:01<42:50,  4.08it/s] 18%|█▊        | 2230/12724 [09:20<42:50,  4.08it/s] 20%|█▉        | 2484/12724 [10:01<41:21,  4.13it/s] 20%|█▉        | 2484/12724 [10:20<41:21,  4.13it/s] 21%|██▏       | 2732/12724 [11:01<40:22,  4.12it/s] 21%|██▏       | 2732/12724 [11:20<40:22,  4.12it/s] 23%|██▎       | 2977/12724 [12:02<39:32,  4.11it/s] 23%|██▎       | 2977/12724 [12:20<39:32,  4.11it/s] 25%|██▌       | 3219/12724 [13:02<38:47,  4.08it/s] 25%|██▌       | 3219/12724 [13:20<38:47,  4.08it/s] 27%|██▋       | 3470/12724 [14:02<37:31,  4.11it/s] 27%|██▋       | 3470/12724 [14:20<37:31,  4.11it/s] 29%|██▉       | 3714/12724 [15:02<36:40,  4.09it/s] 29%|██▉       | 3714/12724 [15:20<36:40,  4.09it/s] 31%|███       | 3944/12724 [16:02<36:28,  4.01it/s] 31%|███       | 3944/12724 [16:20<36:28,  4.01it/s] 33%|███▎      | 4181/12724 [17:02<35:41,  3.99it/s] 33%|███▎      | 4181/12724 [17:20<35:41,  3.99it/s] 35%|███▍      | 4417/12724 [18:02<34:51,  3.97it/s] 35%|███▍      | 4417/12724 [18:20<34:51,  3.97it/s] 37%|███▋      | 4657/12724 [19:02<33:46,  3.98it/s] 37%|███▋      | 4657/12724 [19:20<33:46,  3.98it/s] 38%|███▊      | 4893/12724 [20:02<32:54,  3.97it/s] 38%|███▊      | 4893/12724 [20:20<32:54,  3.97it/s] 40%|████      | 5137/12724 [21:02<31:39,  3.99it/s] 40%|████      | 5137/12724 [21:20<31:39,  3.99it/s] 42%|████▏     | 5375/12724 [22:03<30:44,  3.98it/s] 42%|████▏     | 5375/12724 [22:20<30:44,  3.98it/s] 44%|████▍     | 5625/12724 [23:03<29:18,  4.04it/s] 44%|████▍     | 5625/12724 [23:20<29:18,  4.04it/s] 46%|████▌     | 5865/12724 [24:03<28:23,  4.03it/s] 46%|████▌     | 5865/12724 [24:20<28:23,  4.03it/s] 48%|████▊     | 6107/12724 [25:03<27:22,  4.03it/s] 48%|████▊     | 6107/12724 [25:20<27:22,  4.03it/s] 50%|████▉     | 6338/12724 [26:03<26:48,  3.97it/s] 50%|████▉     | 6338/12724 [26:20<26:48,  3.97it/s] 52%|█████▏    | 6576/12724 [27:03<25:50,  3.96it/s] 52%|█████▏    | 6576/12724 [27:20<25:50,  3.96it/s] 54%|█████▎    | 6816/12724 [28:03<24:48,  3.97it/s] 54%|█████▎    | 6816/12724 [28:20<24:48,  3.97it/s] 55%|█████▌    | 7061/12724 [29:03<23:34,  4.00it/s] 55%|█████▌    | 7061/12724 [29:20<23:34,  4.00it/s] 57%|█████▋    | 7305/12724 [30:04<22:27,  4.02it/s] 57%|█████▋    | 7305/12724 [30:20<22:27,  4.02it/s] 59%|█████▉    | 7551/12724 [31:04<21:19,  4.04it/s] 59%|█████▉    | 7551/12724 [31:20<21:19,  4.04it/s] 61%|██████▏   | 7796/12724 [32:04<20:15,  4.05it/s] 61%|██████▏   | 7796/12724 [32:20<20:15,  4.05it/s] 63%|██████▎   | 8045/12724 [33:04<19:06,  4.08it/s] 63%|██████▎   | 8045/12724 [33:20<19:06,  4.08it/s] 65%|██████▌   | 8294/12724 [34:04<18:01,  4.10it/s] 65%|██████▌   | 8294/12724 [34:20<18:01,  4.10it/s] 67%|██████▋   | 8541/12724 [35:04<17:00,  4.10it/s] 67%|██████▋   | 8541/12724 [35:20<17:00,  4.10it/s] 69%|██████▉   | 8788/12724 [36:04<15:58,  4.11it/s] 69%|██████▉   | 8788/12724 [36:20<15:58,  4.11it/s] 71%|███████   | 9037/12724 [37:04<14:55,  4.12it/s] 71%|███████   | 9037/12724 [37:20<14:55,  4.12it/s] 73%|███████▎  | 9282/12724 [38:04<13:58,  4.10it/s] 73%|███████▎  | 9282/12724 [38:20<13:58,  4.10it/s] 75%|███████▍  | 9524/12724 [39:04<13:04,  4.08it/s] 75%|███████▍  | 9524/12724 [39:20<13:04,  4.08it/s] 77%|███████▋  | 9764/12724 [40:05<12:10,  4.05it/s] 77%|███████▋  | 9764/12724 [40:20<12:10,  4.05it/s] 79%|███████▊  | 10002/12724 [41:05<11:16,  4.02it/s] 79%|███████▊  | 10002/12724 [41:20<11:16,  4.02it/s] 80%|████████  | 10240/12724 [42:05<10:20,  4.01it/s] 80%|████████  | 10240/12724 [42:20<10:20,  4.01it/s] 82%|████████▏ | 10485/12724 [43:05<09:16,  4.02it/s] 82%|████████▏ | 10485/12724 [43:20<09:16,  4.02it/s] 84%|████████▍ | 10721/12724 [44:05<08:21,  4.00it/s] 84%|████████▍ | 10721/12724 [44:20<08:21,  4.00it/s] 86%|████████▌ | 10965/12724 [45:05<07:17,  4.02it/s] 86%|████████▌ | 10965/12724 [45:20<07:17,  4.02it/s] 88%|████████▊ | 11206/12724 [46:05<06:18,  4.02it/s] 88%|████████▊ | 11206/12724 [46:20<06:18,  4.02it/s] 90%|████████▉ | 11450/12724 [47:05<05:16,  4.03it/s] 90%|████████▉ | 11450/12724 [47:20<05:16,  4.03it/s] 92%|█████████▏| 11698/12724 [48:05<04:12,  4.06it/s] 92%|█████████▏| 11698/12724 [48:20<04:12,  4.06it/s] 94%|█████████▍| 11942/12724 [49:05<03:12,  4.06it/s] 94%|█████████▍| 11942/12724 [49:20<03:12,  4.06it/s] 96%|█████████▌| 12186/12724 [50:06<02:12,  4.06it/s] 96%|█████████▌| 12186/12724 [50:20<02:12,  4.06it/s] 98%|█████████▊| 12425/12724 [51:06<01:14,  4.03it/s] 98%|█████████▊| 12425/12724 [51:20<01:14,  4.03it/s]100%|█████████▉| 12669/12724 [52:06<00:13,  4.04it/s]100%|██████████| 12724/12724 [52:19<00:00,  4.05it/s]
  0%|          | 0/12724 [00:00<?, ?it/s]  1%|          | 119/12724 [01:00<1:46:45,  1.97it/s]  1%|          | 119/12724 [01:10<1:46:45,  1.97it/s]  2%|▏         | 239/12724 [02:00<1:45:03,  1.98it/s]  2%|▏         | 239/12724 [02:10<1:45:03,  1.98it/s]  3%|▎         | 361/12724 [03:01<1:43:01,  2.00it/s]  3%|▎         | 361/12724 [03:20<1:43:01,  2.00it/s]  4%|▍         | 487/12724 [04:01<1:40:20,  2.03it/s]  4%|▍         | 487/12724 [04:20<1:40:20,  2.03it/s]  5%|▍         | 609/12724 [05:01<1:39:29,  2.03it/s]  5%|▍         | 609/12724 [05:20<1:39:29,  2.03it/s]  6%|▌         | 735/12724 [06:02<1:37:23,  2.05it/s]  6%|▌         | 735/12724 [06:20<1:37:23,  2.05it/s]  7%|▋         | 856/12724 [07:02<1:37:08,  2.04it/s]  7%|▋         | 856/12724 [07:20<1:37:08,  2.04it/s]  8%|▊         | 980/12724 [08:02<1:35:49,  2.04it/s]  8%|▊         | 980/12724 [08:20<1:35:49,  2.04it/s]  9%|▊         | 1101/12724 [09:02<1:35:16,  2.03it/s]  9%|▊         | 1101/12724 [09:20<1:35:16,  2.03it/s] 10%|▉         | 1228/12724 [10:03<1:33:16,  2.05it/s] 10%|▉         | 1228/12724 [10:20<1:33:16,  2.05it/s] 11%|█         | 1347/12724 [11:03<1:33:25,  2.03it/s] 11%|█         | 1347/12724 [11:20<1:33:25,  2.03it/s] 12%|█▏        | 1471/12724 [12:03<1:31:57,  2.04it/s] 12%|█▏        | 1471/12724 [12:20<1:31:57,  2.04it/s] 13%|█▎        | 1591/12724 [13:04<1:31:43,  2.02it/s] 13%|█▎        | 1591/12724 [13:20<1:31:43,  2.02it/s] 13%|█▎        | 1714/12724 [14:04<1:30:29,  2.03it/s] 13%|█▎        | 1714/12724 [14:20<1:30:29,  2.03it/s] 14%|█▍        | 1822/12724 [15:04<1:32:47,  1.96it/s] 14%|█▍        | 1822/12724 [15:20<1:32:47,  1.96it/s] 15%|█▌        | 1935/12724 [16:05<1:33:08,  1.93it/s] 15%|█▌        | 1935/12724 [16:20<1:33:08,  1.93it/s] 16%|█▌        | 2049/12724 [17:05<1:32:38,  1.92it/s] 16%|█▌        | 2049/12724 [17:20<1:32:38,  1.92it/s] 17%|█▋        | 2158/12724 [18:05<1:33:21,  1.89it/s] 17%|█▋        | 2158/12724 [18:20<1:33:21,  1.89it/s] 18%|█▊        | 2267/12724 [19:05<1:33:27,  1.86it/s] 18%|█▊        | 2267/12724 [19:20<1:33:27,  1.86it/s] 19%|█▊        | 2380/12724 [20:05<1:32:12,  1.87it/s] 19%|█▊        | 2380/12724 [20:20<1:32:12,  1.87it/s] 20%|█▉        | 2495/12724 [21:05<1:30:34,  1.88it/s] 20%|█▉        | 2495/12724 [21:20<1:30:34,  1.88it/s] 20%|██        | 2607/12724 [22:05<1:29:50,  1.88it/s] 20%|██        | 2607/12724 [22:20<1:29:50,  1.88it/s] 21%|██▏       | 2725/12724 [23:06<1:27:36,  1.90it/s] 21%|██▏       | 2725/12724 [23:20<1:27:36,  1.90it/s] 22%|██▏       | 2852/12724 [24:06<1:23:46,  1.96it/s] 22%|██▏       | 2852/12724 [24:20<1:23:46,  1.96it/s] 23%|██▎       | 2971/12724 [25:06<1:22:35,  1.97it/s] 23%|██▎       | 2971/12724 [25:20<1:22:35,  1.97it/s] 24%|██▍       | 3093/12724 [26:06<1:20:46,  1.99it/s] 24%|██▍       | 3093/12724 [26:20<1:20:46,  1.99it/s] 25%|██▌       | 3214/12724 [27:06<1:19:26,  1.99it/s] 25%|██▌       | 3214/12724 [27:20<1:19:26,  1.99it/s] 26%|██▌       | 3340/12724 [28:06<1:17:16,  2.02it/s] 26%|██▌       | 3340/12724 [28:20<1:17:16,  2.02it/s] 27%|██▋       | 3466/12724 [29:07<1:15:28,  2.04it/s] 27%|██▋       | 3466/12724 [29:20<1:15:28,  2.04it/s] 28%|██▊       | 3591/12724 [30:07<1:14:02,  2.06it/s] 28%|██▊       | 3591/12724 [30:20<1:14:02,  2.06it/s] 29%|██▉       | 3715/12724 [31:07<1:13:05,  2.05it/s] 29%|██▉       | 3715/12724 [31:20<1:13:05,  2.05it/s] 30%|███       | 3836/12724 [32:07<1:12:36,  2.04it/s] 30%|███       | 3836/12724 [32:20<1:12:36,  2.04it/s] 31%|███       | 3954/12724 [33:08<1:12:32,  2.01it/s] 31%|███       | 3954/12724 [33:20<1:12:32,  2.01it/s] 32%|███▏      | 4068/12724 [34:08<1:12:58,  1.98it/s] 32%|███▏      | 4068/12724 [34:20<1:12:58,  1.98it/s] 33%|███▎      | 4189/12724 [35:08<1:11:32,  1.99it/s] 33%|███▎      | 4189/12724 [35:20<1:11:32,  1.99it/s] 34%|███▍      | 4309/12724 [36:09<1:10:33,  1.99it/s] 34%|███▍      | 4309/12724 [36:20<1:10:33,  1.99it/s] 35%|███▍      | 4424/12724 [37:09<1:10:23,  1.97it/s] 35%|███▍      | 4424/12724 [37:20<1:10:23,  1.97it/s] 36%|███▌      | 4542/12724 [38:09<1:09:29,  1.96it/s] 36%|███▌      | 4542/12724 [38:20<1:09:29,  1.96it/s] 37%|███▋      | 4663/12724 [39:09<1:07:58,  1.98it/s] 37%|███▋      | 4663/12724 [39:20<1:07:58,  1.98it/s] 38%|███▊      | 4779/12724 [40:09<1:07:27,  1.96it/s] 38%|███▊      | 4779/12724 [40:20<1:07:27,  1.96it/s] 39%|███▊      | 4899/12724 [41:10<1:06:11,  1.97it/s] 39%|███▊      | 4899/12724 [41:20<1:06:11,  1.97it/s] 39%|███▉      | 5021/12724 [42:10<1:04:34,  1.99it/s] 39%|███▉      | 5021/12724 [42:20<1:04:34,  1.99it/s] 40%|████      | 5142/12724 [43:10<1:03:23,  1.99it/s] 40%|████      | 5142/12724 [43:20<1:03:23,  1.99it/s] 41%|████▏     | 5263/12724 [44:11<1:02:18,  2.00it/s] 41%|████▏     | 5263/12724 [44:30<1:02:18,  2.00it/s] 42%|████▏     | 5381/12724 [45:11<1:01:38,  1.99it/s] 42%|████▏     | 5381/12724 [45:30<1:01:38,  1.99it/s] 43%|████▎     | 5500/12724 [46:11<1:00:40,  1.98it/s] 43%|████▎     | 5500/12724 [46:30<1:00:40,  1.98it/s] 44%|████▍     | 5630/12724 [47:11<58:07,  2.03it/s]   44%|████▍     | 5630/12724 [47:30<58:07,  2.03it/s] 45%|████▌     | 5749/12724 [48:12<57:43,  2.01it/s] 45%|████▌     | 5749/12724 [48:30<57:43,  2.01it/s] 46%|████▌     | 5867/12724 [49:12<57:12,  2.00it/s] 46%|████▌     | 5867/12724 [49:30<57:12,  2.00it/s] 47%|████▋     | 5987/12724 [50:12<56:17,  1.99it/s] 47%|████▋     | 5987/12724 [50:30<56:17,  1.99it/s] 48%|████▊     | 6106/12724 [51:12<55:23,  1.99it/s] 48%|████▊     | 6106/12724 [51:30<55:23,  1.99it/s] 49%|████▉     | 6220/12724 [52:13<55:17,  1.96it/s] 49%|████▉     | 6220/12724 [52:30<55:17,  1.96it/s] 50%|████▉     | 6339/12724 [53:13<54:08,  1.97it/s] 50%|████▉     | 6339/12724 [53:30<54:08,  1.97it/s] 51%|█████     | 6460/12724 [54:13<52:50,  1.98it/s] 51%|█████     | 6460/12724 [54:31<52:50,  1.98it/s] 52%|█████▏    | 6578/12724 [55:14<51:57,  1.97it/s] 52%|█████▏    | 6578/12724 [55:31<51:57,  1.97it/s] 53%|█████▎    | 6695/12724 [56:14<51:10,  1.96it/s] 53%|█████▎    | 6695/12724 [56:31<51:10,  1.96it/s] 54%|█████▎    | 6817/12724 [57:14<49:37,  1.98it/s] 54%|█████▎    | 6817/12724 [57:31<49:37,  1.98it/s] 55%|█████▍    | 6936/12724 [58:14<48:40,  1.98it/s] 55%|█████▍    | 6936/12724 [58:31<48:40,  1.98it/s] 56%|█████▌    | 7063/12724 [59:14<46:39,  2.02it/s] 56%|█████▌    | 7063/12724 [59:31<46:39,  2.02it/s] 56%|█████▋    | 7185/12724 [1:00:14<45:35,  2.02it/s] 56%|█████▋    | 7185/12724 [1:00:31<45:35,  2.02it/s] 57%|█████▋    | 7306/12724 [1:01:14<44:43,  2.02it/s] 57%|█████▋    | 7306/12724 [1:01:31<44:43,  2.02it/s] 58%|█████▊    | 7432/12724 [1:02:15<43:17,  2.04it/s] 58%|█████▊    | 7432/12724 [1:02:31<43:17,  2.04it/s] 59%|█████▉    | 7548/12724 [1:03:15<43:02,  2.00it/s] 59%|█████▉    | 7548/12724 [1:03:31<43:02,  2.00it/s] 60%|██████    | 7669/12724 [1:04:16<42:02,  2.00it/s] 60%|██████    | 7669/12724 [1:04:31<42:02,  2.00it/s] 61%|██████    | 7790/12724 [1:05:16<40:57,  2.01it/s] 61%|██████    | 7790/12724 [1:05:31<40:57,  2.01it/s] 62%|██████▏   | 7912/12724 [1:06:16<39:53,  2.01it/s] 62%|██████▏   | 7912/12724 [1:06:31<39:53,  2.01it/s] 63%|██████▎   | 8035/12724 [1:07:17<38:43,  2.02it/s] 63%|██████▎   | 8035/12724 [1:07:31<38:43,  2.02it/s] 64%|██████▍   | 8160/12724 [1:08:17<37:23,  2.03it/s] 64%|██████▍   | 8160/12724 [1:08:31<37:23,  2.03it/s] 65%|██████▌   | 8280/12724 [1:09:17<36:38,  2.02it/s] 65%|██████▌   | 8280/12724 [1:09:31<36:38,  2.02it/s] 66%|██████▌   | 8399/12724 [1:10:18<35:56,  2.01it/s] 66%|██████▌   | 8399/12724 [1:10:31<35:56,  2.01it/s] 67%|██████▋   | 8519/12724 [1:11:18<35:01,  2.00it/s] 67%|██████▋   | 8519/12724 [1:11:31<35:01,  2.00it/s] 68%|██████▊   | 8637/12724 [1:12:18<34:13,  1.99it/s] 68%|██████▊   | 8637/12724 [1:12:31<34:13,  1.99it/s] 69%|██████▉   | 8759/12724 [1:13:18<32:59,  2.00it/s] 69%|██████▉   | 8759/12724 [1:13:31<32:59,  2.00it/s] 70%|██████▉   | 8878/12724 [1:14:18<32:08,  1.99it/s] 70%|██████▉   | 8878/12724 [1:14:31<32:08,  1.99it/s] 71%|███████   | 9003/12724 [1:15:18<30:41,  2.02it/s] 71%|███████   | 9003/12724 [1:15:31<30:41,  2.02it/s] 72%|███████▏  | 9123/12724 [1:16:18<29:49,  2.01it/s] 72%|███████▏  | 9123/12724 [1:16:31<29:49,  2.01it/s] 73%|███████▎  | 9248/12724 [1:17:19<28:32,  2.03it/s] 73%|███████▎  | 9248/12724 [1:17:31<28:32,  2.03it/s] 74%|███████▎  | 9368/12724 [1:18:19<27:41,  2.02it/s] 74%|███████▎  | 9368/12724 [1:18:31<27:41,  2.02it/s] 75%|███████▍  | 9491/12724 [1:19:19<26:33,  2.03it/s] 75%|███████▍  | 9491/12724 [1:19:31<26:33,  2.03it/s] 76%|███████▌  | 9612/12724 [1:20:19<25:40,  2.02it/s] 76%|███████▌  | 9612/12724 [1:20:31<25:40,  2.02it/s] 76%|███████▋  | 9732/12724 [1:21:20<24:47,  2.01it/s] 76%|███████▋  | 9732/12724 [1:21:31<24:47,  2.01it/s] 77%|███████▋  | 9854/12724 [1:22:20<23:44,  2.01it/s] 77%|███████▋  | 9854/12724 [1:22:31<23:44,  2.01it/s] 78%|███████▊  | 9970/12724 [1:23:20<23:04,  1.99it/s] 78%|███████▊  | 9970/12724 [1:23:31<23:04,  1.99it/s] 79%|███████▉  | 10090/12724 [1:24:20<22:03,  1.99it/s] 79%|███████▉  | 10090/12724 [1:24:31<22:03,  1.99it/s] 80%|████████  | 10213/12724 [1:25:20<20:51,  2.01it/s] 80%|████████  | 10213/12724 [1:25:31<20:51,  2.01it/s] 81%|████████  | 10338/12724 [1:26:21<19:38,  2.02it/s] 81%|████████  | 10338/12724 [1:26:41<19:38,  2.02it/s] 82%|████████▏ | 10461/12724 [1:27:21<18:33,  2.03it/s] 82%|████████▏ | 10461/12724 [1:27:41<18:33,  2.03it/s] 83%|████████▎ | 10578/12724 [1:28:21<17:50,  2.01it/s] 83%|████████▎ | 10578/12724 [1:28:41<17:50,  2.01it/s] 84%|████████▍ | 10699/12724 [1:29:21<16:49,  2.01it/s] 84%|████████▍ | 10699/12724 [1:29:41<16:49,  2.01it/s] 85%|████████▌ | 10820/12724 [1:30:22<15:48,  2.01it/s] 85%|████████▌ | 10820/12724 [1:30:41<15:48,  2.01it/s] 86%|████████▌ | 10943/12724 [1:31:22<14:42,  2.02it/s] 86%|████████▌ | 10943/12724 [1:31:41<14:42,  2.02it/s] 87%|████████▋ | 11070/12724 [1:32:22<13:29,  2.04it/s] 87%|████████▋ | 11070/12724 [1:32:41<13:29,  2.04it/s] 88%|████████▊ | 11193/12724 [1:33:23<12:30,  2.04it/s] 88%|████████▊ | 11193/12724 [1:33:41<12:30,  2.04it/s] 89%|████████▉ | 11317/12724 [1:34:23<11:28,  2.04it/s] 89%|████████▉ | 11317/12724 [1:34:41<11:28,  2.04it/s] 90%|████████▉ | 11444/12724 [1:35:23<10:20,  2.06it/s] 90%|████████▉ | 11444/12724 [1:35:41<10:20,  2.06it/s] 91%|█████████ | 11572/12724 [1:36:24<09:14,  2.08it/s] 91%|█████████ | 11572/12724 [1:36:41<09:14,  2.08it/s] 92%|█████████▏| 11701/12724 [1:37:24<08:07,  2.10it/s] 92%|█████████▏| 11701/12724 [1:37:41<08:07,  2.10it/s] 93%|█████████▎| 11827/12724 [1:38:24<07:08,  2.09it/s] 93%|█████████▎| 11827/12724 [1:38:41<07:08,  2.09it/s] 94%|█████████▍| 11954/12724 [1:39:25<06:06,  2.10it/s] 94%|█████████▍| 11954/12724 [1:39:41<06:06,  2.10it/s] 95%|█████████▍| 12080/12724 [1:40:25<05:07,  2.10it/s] 95%|█████████▍| 12080/12724 [1:40:41<05:07,  2.10it/s] 96%|█████████▌| 12206/12724 [1:41:25<04:07,  2.09it/s] 96%|█████████▌| 12206/12724 [1:41:41<04:07,  2.09it/s] 97%|█████████▋| 12330/12724 [1:42:26<03:09,  2.08it/s] 97%|█████████▋| 12330/12724 [1:42:41<03:09,  2.08it/s] 98%|█████████▊| 12453/12724 [1:43:26<02:10,  2.07it/s] 98%|█████████▊| 12453/12724 [1:43:41<02:10,  2.07it/s] 99%|█████████▉| 12576/12724 [1:44:26<01:11,  2.06it/s] 99%|█████████▉| 12576/12724 [1:44:41<01:11,  2.06it/s]100%|█████████▉| 12698/12724 [1:45:26<00:12,  2.06it/s]100%|██████████| 12724/12724 [1:45:38<00:00,  2.01it/s]
      sub_label obj_label relation                                   masked_sentences                                         sub_sister  uuid  sub_position sub_label_sg  sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap                         sub_label_sgpl  obj_in_BERT                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                               subj_anchors_wordnet                         subj_anchors_wordnet_score                            subj_anchors_wordnet_sg  \
0          golo   [river]      IsA        [A golo is a [MASK]., A golo is an [MASK].]                                                 []     0             2         golo          golo  [a golo is a [MASK]., a golo is a type of [MAS...  [a golo or [Z] is a [MASK]., a golo or [Z] is ...  [[MASK] such as golo., [MASK], including golo....  [[MASK] such as golo and [Z]., [MASK], includi...  [such as golo and [MASK]., such as golo or [MA...                         golo golo golo            1  [animal, elephant, donkey, dog, fish, eel, acc...  {'animal': -6.888653904527905, 'elephant': -8....  [fish, drum, bird, boat, dog, donkey, canoe, p...  {'fish': -9.915112659666699, 'drum': -10.30261...  [story, yes, poems, place, people, animal, thi...  {'stories': -8.78155184429648, 'yes': -9.04343...  [human, bird, dog, animal, italy, cow, horse, ...  {'human': 0.10946393013000488, 'bird': 0.04091...                  [human, bird, dog, animal, italy]   
1     kerrobert    [town]      IsA  [A kerrobert is a [MASK]., A kerrobert is an [...                                                 []     1             2    kerrobert     kerrobert  [a kerrobert is a [MASK]., a kerrobert is a ty...  [a kerrobert or [Z] is a [MASK]., a kerrobert ...  [[MASK] such as kerrobert., [MASK], including ...  [[MASK] such as kerrobert and [Z]., [MASK], in...  [such as kerrobert and [MASK]., such as kerrob...          kerrobert kerrobert kerrobert            1  [asteroid, acronym, aircraft, automobile, umbr...  {'asteroid': -9.461400115751571, 'acronym': -1...  [reactor, robot, explosive, cannon, bomb, ball...  {'reactor': -10.873440118965053, 'robot': -11....  [company, brand, works, name, place, source, w...  {'companies': -9.819514575902069, 'brands': -1...  [human, germany, france, robert, person, man, ...  {'human': 0.020311232656240463, 'germany': 0.0...           [human, germany, france, robert, person]   
2     geometria    [film]      IsA  [A geometria is a [MASK]., A geometria is an [...                                                 []     2             2    geometria     geometria  [a geometria is a [MASK]., a geometria is a ty...  [a geometria or [Z] is a [MASK]., a geometria ...  [[MASK] such as geometria., [MASK], including ...  [[MASK] such as geometria and [Z]., [MASK], in...  [such as geometria and [MASK]., such as geomet...          geometria geometria geometria            1  [object, algebra, manifold, dimension, surface...  {'object': -6.18670296737651, 'algebra': -7.88...  [manifold, geometry, space, structure, surface...  {'manifold': -7.623828773356801, 'geometry': -...  [geometry, mathematics, object, thing, concept...  {'geometry': -7.179117777640198, 'mathematics'...  [geometry, spheres, mathematics, physics, astr...  {'geometry': 0.1543659440834414, 'spheres': 0....  [geometry, sphere, mathematics, physics, astro...   
3  evaporations   [place]      IsA  [An evaporation is a [MASK]., An evaporation i...  [melting, vapour, thawing, thaw, vaporisation,...     3             3  evaporation  evaporations  [an evaporation is a [MASK]., an evaporation i...  [an evaporation or [Z] is a [MASK]., an evapor...  [[MASK] such as evaporations., [MASK], includi...  [[MASK] such as evaporations and [Z]., [MASK],...  [such as evaporations and [MASK]., such as eva...  evaporations evaporation evaporations            1  [process, explosion, precipitation, expansion,...  {'process': -7.783032526316761, 'explosion': -...  [precipitation, process, liquid, reaction, dro...  {'precipitation': -6.517468626047083, 'process...  [phenomenon, precipitation, process, liquid, f...  {'phenomena': -7.646275684013182, 'precipitati...  [precipitation, convection, water, rain, vapor...  {'precipitation': 0.1365729719400406, 'convect...    [precipitation, convection, water, rain, vapor]   
4     boneheads    [band]      IsA  [A bonehead is a [MASK]., A bonehead is an [MA...  [knucklehead, hammerhead, loggerhead, dumbass,...     4             2     bonehead     boneheads  [a bonehead is a [MASK]., a bonehead is a type...  [a bonehead or [Z] is a [MASK]., a bonehead or...  [[MASK] such as boneheads., [MASK], including ...  [[MASK] such as boneheads and [Z]., [MASK], in...  [such as boneheads and [MASK]., such as bonehe...           boneheads bonehead boneheads            1  [animal, individual, actor, insect, anchor, el...  {'animal': -7.760352993909391, 'individual': -...  [fish, turtle, bird, bone, animal, catfish, pi...  {'fish': -9.285614179926169, 'turtle': -9.8092...  [yeah, bone, people, thing, animal, band, yes,...  {'yeah': -8.830292573364021, 'bones': -9.55534...  [women, apparently, idiots, human, maybe, skul...  {'women': 0.05045162979513407, 'apparently': 0...           [woman, apparently, idiot, human, maybe]   

                             subj_anchors_wordnet_pl                           subj_anchors_wordnet_all                  subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor                           lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0               [human, birds, dogs, animals, italy]  [human, bird, dog, animal, italy, cow, horse, ...                         golo golo golo          10  [a golo or a human is a [MASK]., a golo or a b...  [[MASK] such as golo and human., [MASK] such a...  [animal, bird, dog, human, fish, creature, per...  {'animal': -8.453092909668728, 'bird': -8.9341...  [animal, dog, country, thing, creature, bird, ...  {'animals': -7.056320994508575, 'dogs': -10.10...  
1          [human, germany, france, robert, persons]  [human, germany, france, robert, person, man, ...          kerrobert kerrobert kerrobert          10  [a kerrobert or a human is a [MASK]., a kerrob...  [[MASK] such as kerrobert and human., [MASK] s...  [robot, person, human, animal, car, bird, ship...  {'robot': -9.927339991055504, 'person': -10.26...  [company, brand, place, country, france, artis...  {'companies': -8.79763481047723, 'brands': -9....  
2  [geometries, spheres, mathematics, physics, as...  [geometry, sphere, mathematics, physics, astro...          geometria geometria geometria          10  [a geometria or a geometry is a [MASK]., a geo...  [[MASK] such as geometria and geometries., [MA...  [geometry, space, manifold, mathematics, dimen...  {'geometry': -6.5387478598312905, 'space': -8....  [topic, subject, field, mathematics, geometry,...  {'topics': -8.708573551386543, 'subjects': -8....  
3  [precipitations, convection, waters, rains, va...  [precipitation, convection, water, rain, vapor...  evaporations evaporation evaporations          10  [an evaporation or a precipitation is a [MASK]...  [[MASK] such as evaporations and precipitation...  [precipitation, liquid, process, reaction, rai...  {'precipitation': -6.78301539070394, 'liquid':...  [phenomenon, precipitation, process, thing, ev...  {'phenomena': -7.451663052150623, 'precipitati...  
4          [women, apparently, idiots, human, maybe]  [woman, apparently, idiot, human, maybe, skull...           boneheads bonehead boneheads          10  [a bonehead or a woman is a [MASK]., a bonehea...  [[MASK] such as boneheads and women., [MASK] s...  [animal, human, person, fish, woman, man, bone...  {'animal': -9.642568288317667, 'human': -9.844...  [thing, people, yeah, yes, animal, group, woma...  {'things': -8.589455347830842, 'people': -9.00...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:809: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:882: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type                	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_wordnet_sg  	  21.8 	  38.7 	   38.7 	    28 
  1 	 subj_anchors_wordnet_all 	  21.8 	  38.7 	   46.4 	    29 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	   3.8 	   9.7 	   12.8 	   6.3 	              1 
  2 	 lsp_sap     	   4.7 	  15.4 	   22.1 	   9.4 	              3 
  3 	 def_dap     	   4.2 	  10.9 	   15.5 	   7.1 	              2 
  4 	 lsp_dap     	   5.3 	  15.9 	   21.5 	   9.8 	              4 
hline
end{tabular}
save log/bert-large-uncased/hypernymsuite/SHWARTZ/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.SHWARTZ.tsv
save log/bert-large-uncased/hypernymsuite/SHWARTZ/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_WordNet_wns_False_wnf_True_swow_score_source_None.SHWARTZ.csv
