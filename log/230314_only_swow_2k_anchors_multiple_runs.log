debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWStrength', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                       subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...                          [whisker, catsup]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...        [lime, sour, citrus, yellow, rinds]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...         [shell, slow, tortoise, sea, neck]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [satchel, sack, purse, shopping, plastic]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...      [bunny, roger, carrot, white, rodent]
...                                                 ...                                        ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...    [author, book, novel, poet, typewriter]
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...          [meter, barn, stick, lawns, sale]

[2083 rows x 2 columns]
                                                lsp_dap                          subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...                           [whiskers, catsups]
1     [[MASK] such as lemon and [Z]., [MASK], includ...        [limes, sour, citruses, yellow, rinds]
2     [[MASK] such as turtles and [Z]., [MASK], incl...        [shells, slow, tortoises, seas, necks]
3     [[MASK] such as bags and [Z]., [MASK], includi...   [satchel, sack, purses, shopping, plastics]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...        [bunny, roger, carrots, white, rodent]
...                                                 ...                                           ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [authors, books, novels, poets, typewriters]
2093  [[MASK] such as yard and [Z]., [MASK], includi...           [meters, barn, stick, lawns, sales]

[2083 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2083 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▍        | 296/2083 [01:00<06:03,  4.92it/s] 14%|█▍        | 296/2083 [01:20<06:03,  4.92it/s] 29%|██▊       | 597/2083 [02:00<04:58,  4.97it/s] 29%|██▊       | 597/2083 [02:20<04:58,  4.97it/s] 43%|████▎     | 905/2083 [03:00<03:53,  5.04it/s] 43%|████▎     | 905/2083 [03:20<03:53,  5.04it/s] 58%|█████▊    | 1206/2083 [04:00<02:54,  5.03it/s] 58%|█████▊    | 1206/2083 [04:20<02:54,  5.03it/s] 72%|███████▏  | 1506/2083 [05:00<01:55,  5.02it/s] 72%|███████▏  | 1506/2083 [05:20<01:55,  5.02it/s] 86%|████████▌ | 1788/2083 [06:00<01:00,  4.91it/s] 86%|████████▌ | 1788/2083 [06:20<01:00,  4.91it/s] 99%|█████████▉| 2068/2083 [07:00<00:03,  4.83it/s]100%|██████████| 2083/2083 [07:03<00:00,  4.91it/s]
  0%|          | 0/2083 [00:00<?, ?it/s]  7%|▋         | 151/2083 [01:00<12:49,  2.51it/s]  7%|▋         | 151/2083 [01:16<12:49,  2.51it/s] 14%|█▍        | 296/2083 [02:00<12:08,  2.45it/s] 14%|█▍        | 296/2083 [02:16<12:08,  2.45it/s] 21%|██▏       | 447/2083 [03:00<10:59,  2.48it/s] 21%|██▏       | 447/2083 [03:16<10:59,  2.48it/s] 29%|██▊       | 596/2083 [04:00<09:59,  2.48it/s] 29%|██▊       | 596/2083 [04:16<09:59,  2.48it/s] 36%|███▌      | 749/2083 [05:00<08:52,  2.50it/s] 36%|███▌      | 749/2083 [05:16<08:52,  2.50it/s] 43%|████▎     | 901/2083 [06:00<07:50,  2.51it/s] 43%|████▎     | 901/2083 [06:16<07:50,  2.51it/s] 51%|█████     | 1053/2083 [07:00<06:49,  2.52it/s] 51%|█████     | 1053/2083 [07:16<06:49,  2.52it/s] 58%|█████▊    | 1202/2083 [08:01<05:52,  2.50it/s] 58%|█████▊    | 1202/2083 [08:16<05:52,  2.50it/s] 65%|██████▍   | 1353/2083 [09:01<04:51,  2.51it/s] 65%|██████▍   | 1353/2083 [09:16<04:51,  2.51it/s] 72%|███████▏  | 1503/2083 [10:01<03:52,  2.50it/s] 72%|███████▏  | 1503/2083 [10:16<03:52,  2.50it/s] 79%|███████▉  | 1644/2083 [11:01<02:59,  2.45it/s] 79%|███████▉  | 1644/2083 [11:16<02:59,  2.45it/s] 86%|████████▌ | 1787/2083 [12:01<02:01,  2.43it/s] 86%|████████▌ | 1787/2083 [12:16<02:01,  2.43it/s] 93%|█████████▎| 1928/2083 [13:01<01:04,  2.41it/s] 93%|█████████▎| 1928/2083 [13:16<01:04,  2.41it/s] 99%|█████████▉| 2069/2083 [14:01<00:05,  2.39it/s]100%|██████████| 2083/2083 [14:07<00:00,  2.46it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                            subj_anchors_swow                       subj_anchors_swow_sg                         subj_anchors_swow_pl                      subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...                          [whiskers, catsups]                          [whisker, catsup]                          [whiskers, catsups]                          [whisker, catsup]  catfish catfish catfish           2  [a catfish or a whisker is a [MASK]., a catfis...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]        lemon lemon lemon           5  [a lemon or a lime is a [MASK]., a lemon or a ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]   turtles turtle turtles           5  [a turtle or a shell is a [MASK]., a turtle or...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]            bags bag bags           5  [a bag or a satchel is a [MASK]., a bag or a s...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]   rabbits rabbit rabbits           5  [a rabbit or a bunny is a [MASK]., a rabbit or...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and whiskers., [MASK] ...  [fish, shrimp, salmon, crab, snake, turtle, mo...  {'fish': -4.589838679403649, 'shrimp': -11.940...  [fish, species, thing, animal, seafood, invert...  {'fish': -5.493127121630919, 'species': -9.990...  
1  [[MASK] such as lemon and limes., [MASK] such ...  [fruit, drink, lime, wine, sour, juice, orange...  {'fruit': -6.589499151730125, 'drink': -8.9572...  [fruit, color, citrus, thing, colour, ingredie...  {'fruits': -7.69108267271473, 'fruit': -8.0804...  
2  [[MASK] such as turtles and shells., [MASK] su...  [animal, bird, fish, shell, mollusk, creature,...  {'animal': -7.700842105760365, 'bird': -7.9388...  [animal, reptile, thing, bird, wildlife, inver...  {'animals': -6.883113296550789, 'reptiles': -7...  
3  [[MASK] such as bags and satchel., [MASK] such...  [container, luggage, backpack, purse, suitcase...  {'container': -7.168006152776794, 'luggage': -...  [thing, item, luggage, object, belongings, goo...  {'things': -8.199002959622673, 'items': -8.396...  
4  [[MASK] such as rabbits and bunny., [MASK] suc...  [mammal, animal, vegetable, carrot, bird, dog,...  {'mammal': -7.279826843389762, 'animal': -7.45...  [animal, mammal, vegetable, rodent, story, pet...  {'animals': -6.538367060768905, 'mammals': -7....  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	   8.4 	  31.6 	   31.6 	  16.8 
  1 	 subj_anchors_swow_all 	   8.4 	  31.6 	   31.6 	  16.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.6 	   46.7 	  23.1 	              1 
  2 	 lsp_sap     	  12.2 	  33   	   44.3 	  21.1 	              3 
  3 	 def_dap     	  14.1 	  37.3 	   49.3 	  23.9 	              2 
  4 	 lsp_dap     	  12.8 	  33   	   45.3 	  21.6 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWStrength', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                       subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...                          [whisker, catsup]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...        [lime, sour, citrus, yellow, rinds]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...         [shell, slow, tortoise, sea, neck]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [satchel, sack, purse, shopping, plastic]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...      [bunny, roger, carrot, white, rodent]
...                                                 ...                                        ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...    [author, book, novel, poet, typewriter]
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...          [meter, barn, stick, lawns, sale]

[2083 rows x 2 columns]
                                                lsp_dap                          subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...                           [whiskers, catsups]
1     [[MASK] such as lemon and [Z]., [MASK], includ...        [limes, sour, citruses, yellow, rinds]
2     [[MASK] such as turtles and [Z]., [MASK], incl...        [shells, slow, tortoises, seas, necks]
3     [[MASK] such as bags and [Z]., [MASK], includi...   [satchel, sack, purses, shopping, plastics]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...        [bunny, roger, carrots, white, rodent]
...                                                 ...                                           ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [authors, books, novels, poets, typewriters]
2093  [[MASK] such as yard and [Z]., [MASK], includi...           [meters, barn, stick, lawns, sales]

[2083 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2083 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▍        | 293/2083 [01:00<06:06,  4.88it/s] 14%|█▍        | 293/2083 [01:20<06:06,  4.88it/s] 28%|██▊       | 591/2083 [02:00<05:02,  4.93it/s] 28%|██▊       | 591/2083 [02:20<05:02,  4.93it/s] 43%|████▎     | 894/2083 [03:00<03:58,  4.98it/s] 43%|████▎     | 894/2083 [03:20<03:58,  4.98it/s] 57%|█████▋    | 1193/2083 [04:00<02:58,  4.98it/s] 57%|█████▋    | 1193/2083 [04:20<02:58,  4.98it/s] 72%|███████▏  | 1492/2083 [05:00<01:58,  4.98it/s] 72%|███████▏  | 1492/2083 [05:20<01:58,  4.98it/s] 85%|████████▌ | 1771/2083 [06:00<01:04,  4.86it/s] 85%|████████▌ | 1771/2083 [06:20<01:04,  4.86it/s] 98%|█████████▊| 2048/2083 [07:00<00:07,  4.78it/s]100%|██████████| 2083/2083 [07:08<00:00,  4.86it/s]
  0%|          | 0/2083 [00:00<?, ?it/s]  7%|▋         | 150/2083 [01:00<12:57,  2.49it/s]  7%|▋         | 150/2083 [01:11<12:57,  2.49it/s] 14%|█▍        | 293/2083 [02:00<12:17,  2.43it/s] 14%|█▍        | 293/2083 [02:11<12:17,  2.43it/s] 21%|██        | 441/2083 [03:00<11:12,  2.44it/s] 21%|██        | 441/2083 [03:11<11:12,  2.44it/s] 28%|██▊       | 589/2083 [04:00<10:09,  2.45it/s] 28%|██▊       | 589/2083 [04:11<10:09,  2.45it/s] 36%|███▌      | 741/2083 [05:01<09:02,  2.47it/s] 36%|███▌      | 741/2083 [05:11<09:02,  2.47it/s] 43%|████▎     | 891/2083 [06:01<08:00,  2.48it/s] 43%|████▎     | 891/2083 [06:11<08:00,  2.48it/s] 50%|█████     | 1043/2083 [07:01<06:56,  2.49it/s] 50%|█████     | 1043/2083 [07:11<06:56,  2.49it/s] 57%|█████▋    | 1189/2083 [08:01<06:01,  2.47it/s] 57%|█████▋    | 1189/2083 [08:11<06:01,  2.47it/s] 64%|██████▍   | 1337/2083 [09:01<05:02,  2.47it/s] 64%|██████▍   | 1337/2083 [09:21<05:02,  2.47it/s] 71%|███████▏  | 1489/2083 [10:02<03:59,  2.48it/s] 71%|███████▏  | 1489/2083 [10:21<03:59,  2.48it/s] 78%|███████▊  | 1629/2083 [11:02<03:06,  2.43it/s] 78%|███████▊  | 1629/2083 [11:21<03:06,  2.43it/s] 85%|████████▌ | 1771/2083 [12:02<02:09,  2.41it/s] 85%|████████▌ | 1771/2083 [12:21<02:09,  2.41it/s] 92%|█████████▏| 1911/2083 [13:02<01:12,  2.38it/s] 92%|█████████▏| 1911/2083 [13:21<01:12,  2.38it/s] 98%|█████████▊| 2051/2083 [14:03<00:13,  2.37it/s]100%|██████████| 2083/2083 [14:17<00:00,  2.43it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                            subj_anchors_swow                       subj_anchors_swow_sg                         subj_anchors_swow_pl                      subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...                          [whiskers, catsups]                          [whisker, catsup]                          [whiskers, catsups]                          [whisker, catsup]  catfish catfish catfish           2  [a catfish or a whisker is a [MASK]., a catfis...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]        lemon lemon lemon           5  [a lemon or a lime is a [MASK]., a lemon or a ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]   turtles turtle turtles           5  [a turtle or a shell is a [MASK]., a turtle or...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]            bags bag bags           5  [a bag or a satchel is a [MASK]., a bag or a s...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]   rabbits rabbit rabbits           5  [a rabbit or a bunny is a [MASK]., a rabbit or...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and whiskers., [MASK] ...  [fish, shrimp, salmon, crab, snake, turtle, mo...  {'fish': -4.589838679403649, 'shrimp': -11.940...  [fish, species, thing, animal, seafood, invert...  {'fish': -5.493127121630919, 'species': -9.990...  
1  [[MASK] such as lemon and limes., [MASK] such ...  [fruit, drink, lime, wine, sour, juice, orange...  {'fruit': -6.589499151730125, 'drink': -8.9572...  [fruit, color, citrus, thing, colour, ingredie...  {'fruits': -7.69108267271473, 'fruit': -8.0804...  
2  [[MASK] such as turtles and shells., [MASK] su...  [animal, bird, fish, shell, mollusk, creature,...  {'animal': -7.700842105760365, 'bird': -7.9388...  [animal, reptile, thing, bird, wildlife, inver...  {'animals': -6.883113296550789, 'reptiles': -7...  
3  [[MASK] such as bags and satchel., [MASK] such...  [container, luggage, backpack, purse, suitcase...  {'container': -7.168006152776794, 'luggage': -...  [thing, item, luggage, object, belongings, goo...  {'things': -8.199002959622673, 'items': -8.396...  
4  [[MASK] such as rabbits and bunny., [MASK] suc...  [mammal, animal, vegetable, carrot, bird, dog,...  {'mammal': -7.279826843389762, 'animal': -7.45...  [animal, mammal, vegetable, rodent, story, pet...  {'animals': -6.538367060768905, 'mammals': -7....  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	   8.4 	  31.6 	   31.6 	  16.8 
  1 	 subj_anchors_swow_all 	   8.4 	  31.6 	   31.6 	  16.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.6 	   46.7 	  23.1 	              1 
  2 	 lsp_sap     	  12.2 	  33   	   44.3 	  21.1 	              3 
  3 	 def_dap     	  14.1 	  37.3 	   49.2 	  24   	              2 
  4 	 lsp_dap     	  12.8 	  33   	   45.3 	  21.6 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWStrength', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                       subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...                          [whisker, catsup]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...        [lime, sour, citrus, yellow, rinds]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...         [shell, slow, tortoise, sea, neck]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [satchel, sack, purse, shopping, plastic]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...      [bunny, roger, carrot, white, rodent]
...                                                 ...                                        ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...          [wide, peaces, planet, war, view]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...    [author, book, novel, poet, typewriter]
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...          [meter, barn, stick, lawns, sale]

[2083 rows x 2 columns]
                                                lsp_dap                          subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...                           [whiskers, catsups]
1     [[MASK] such as lemon and [Z]., [MASK], includ...        [limes, sour, citruses, yellow, rinds]
2     [[MASK] such as turtles and [Z]., [MASK], incl...        [shells, slow, tortoises, seas, necks]
3     [[MASK] such as bags and [Z]., [MASK], includi...   [satchel, sack, purses, shopping, plastics]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...        [bunny, roger, carrots, white, rodent]
...                                                 ...                                           ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...          [wide, peaces, planets, wars, views]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [authors, books, novels, poets, typewriters]
2093  [[MASK] such as yard and [Z]., [MASK], includi...           [meters, barn, stick, lawns, sales]

[2083 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2083 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▍        | 297/2083 [01:00<06:01,  4.94it/s] 14%|█▍        | 297/2083 [01:20<06:01,  4.94it/s] 29%|██▉       | 599/2083 [02:00<04:57,  4.99it/s] 29%|██▉       | 599/2083 [02:20<04:57,  4.99it/s] 44%|████▎     | 907/2083 [03:00<03:52,  5.05it/s] 44%|████▎     | 907/2083 [03:20<03:52,  5.05it/s] 58%|█████▊    | 1209/2083 [04:00<02:53,  5.04it/s] 58%|█████▊    | 1209/2083 [04:20<02:53,  5.04it/s] 72%|███████▏  | 1510/2083 [05:00<01:53,  5.03it/s] 72%|███████▏  | 1510/2083 [05:20<01:53,  5.03it/s] 86%|████████▌ | 1793/2083 [06:00<00:58,  4.92it/s] 86%|████████▌ | 1793/2083 [06:20<00:58,  4.92it/s]100%|█████████▉| 2074/2083 [07:00<00:01,  4.84it/s]100%|██████████| 2083/2083 [07:02<00:00,  4.93it/s]
  0%|          | 0/2083 [00:00<?, ?it/s]  7%|▋         | 152/2083 [01:00<12:45,  2.52it/s]  7%|▋         | 152/2083 [01:17<12:45,  2.52it/s] 14%|█▍        | 298/2083 [02:00<12:04,  2.47it/s] 14%|█▍        | 298/2083 [02:17<12:04,  2.47it/s] 22%|██▏       | 452/2083 [03:00<10:50,  2.51it/s] 22%|██▏       | 452/2083 [03:17<10:50,  2.51it/s] 29%|██▉       | 602/2083 [04:00<09:52,  2.50it/s] 29%|██▉       | 602/2083 [04:17<09:52,  2.50it/s] 36%|███▋      | 757/2083 [05:01<08:44,  2.53it/s] 36%|███▋      | 757/2083 [05:17<08:44,  2.53it/s] 44%|████▍     | 913/2083 [06:01<07:38,  2.55it/s] 44%|████▍     | 913/2083 [06:17<07:38,  2.55it/s] 51%|█████     | 1066/2083 [07:01<06:39,  2.55it/s] 51%|█████     | 1066/2083 [07:17<06:39,  2.55it/s] 58%|█████▊    | 1217/2083 [08:01<05:41,  2.53it/s] 58%|█████▊    | 1217/2083 [08:17<05:41,  2.53it/s] 66%|██████▌   | 1371/2083 [09:01<04:40,  2.54it/s] 66%|██████▌   | 1371/2083 [09:17<04:40,  2.54it/s] 73%|███████▎  | 1522/2083 [10:02<03:41,  2.53it/s] 73%|███████▎  | 1522/2083 [10:17<03:41,  2.53it/s] 80%|███████▉  | 1665/2083 [11:02<02:48,  2.48it/s] 80%|███████▉  | 1665/2083 [11:17<02:48,  2.48it/s] 87%|████████▋ | 1810/2083 [12:02<01:50,  2.46it/s] 87%|████████▋ | 1810/2083 [12:17<01:50,  2.46it/s] 94%|█████████▍| 1954/2083 [13:02<00:52,  2.44it/s] 94%|█████████▍| 1954/2083 [13:17<00:52,  2.44it/s]100%|██████████| 2083/2083 [13:56<00:00,  2.49it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                            subj_anchors_swow                       subj_anchors_swow_sg                         subj_anchors_swow_pl                      subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...                          [whiskers, catsups]                          [whisker, catsup]                          [whiskers, catsups]                          [whisker, catsup]  catfish catfish catfish           2  [a catfish or a whisker is a [MASK]., a catfis...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]       [limes, sour, citruses, yellow, rinds]        [lime, sour, citrus, yellow, rinds]        lemon lemon lemon           5  [a lemon or a lime is a [MASK]., a lemon or a ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]       [shells, slow, tortoises, seas, necks]         [shell, slow, tortoise, sea, neck]   turtles turtle turtles           5  [a turtle or a shell is a [MASK]., a turtle or...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]  [satchel, sack, purses, shopping, plastics]  [satchel, sack, purse, shopping, plastic]            bags bag bags           5  [a bag or a satchel is a [MASK]., a bag or a s...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]       [bunny, roger, carrots, white, rodent]      [bunny, roger, carrot, white, rodent]   rabbits rabbit rabbits           5  [a rabbit or a bunny is a [MASK]., a rabbit or...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and whiskers., [MASK] ...  [fish, shrimp, salmon, crab, snake, turtle, mo...  {'fish': -4.589838679403649, 'shrimp': -11.940...  [fish, species, thing, animal, seafood, invert...  {'fish': -5.493127121630919, 'species': -9.990...  
1  [[MASK] such as lemon and limes., [MASK] such ...  [fruit, drink, lime, wine, sour, juice, orange...  {'fruit': -6.589499151730125, 'drink': -8.9572...  [fruit, color, citrus, thing, colour, ingredie...  {'fruits': -7.69108267271473, 'fruit': -8.0804...  
2  [[MASK] such as turtles and shells., [MASK] su...  [animal, bird, fish, shell, mollusk, creature,...  {'animal': -7.700842105760365, 'bird': -7.9388...  [animal, reptile, thing, bird, wildlife, inver...  {'animals': -6.883113296550789, 'reptiles': -7...  
3  [[MASK] such as bags and satchel., [MASK] such...  [container, luggage, backpack, purse, suitcase...  {'container': -7.168006152776794, 'luggage': -...  [thing, item, luggage, object, belongings, goo...  {'things': -8.199002959622673, 'items': -8.396...  
4  [[MASK] such as rabbits and bunny., [MASK] suc...  [mammal, animal, vegetable, carrot, bird, dog,...  {'mammal': -7.279826843389762, 'animal': -7.45...  [animal, mammal, vegetable, rodent, story, pet...  {'animals': -6.538367060768905, 'mammals': -7....  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	   8.4 	  31.6 	   31.6 	  16.8 
  1 	 subj_anchors_swow_all 	   8.4 	  31.6 	   31.6 	  16.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.6 	   46.7 	  23.1 	              1 
  2 	 lsp_sap     	  12.2 	  33   	   44.3 	  21.1 	              3 
  3 	 def_dap     	  14.1 	  37.3 	   49.3 	  24   	              2 
  4 	 lsp_dap     	  12.8 	  33   	   45.3 	  21.6 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWStrength.ALLSWOW.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWSimilar', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                               subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...        [flatfish, crayfish, fish, catsup, seafood]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...            [citrus, lemon, lime, lemonade, lemony]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...           [tortoise, amphibian, reptile, porpoise]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...            [tote, luggage, carrying, bag, baggage]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...            [rabbit, bunny, hare, breeding, rodent]
...                                                 ...                                                ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...  [editor, manuscript, publication, publish, lit...
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...                 [backyard, grass, acre, mow, inch]

[2094 rows x 2 columns]
                                                lsp_dap                               subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...    [flatfish, crayfish, fishes, catsups, seafoods]
1     [[MASK] such as lemon and [Z]., [MASK], includ...     [citruses, lemons, limes, lemonades, lemonies]
2     [[MASK] such as turtles and [Z]., [MASK], incl...  [tortoises, amphibian, reptile, reptiles, porp...
3     [[MASK] such as bags and [Z]., [MASK], includi...         [tote, luggages, carrying, bags, baggages]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...          [rabbits, bunny, hare, breeding, rodents]
...                                                 ...                                                ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [editors, manuscripts, publications, publish, ...
2093  [[MASK] such as yard and [Z]., [MASK], includi...            [backyard, grasses, acres, mow, inches]

[2094 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2094 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▎        | 283/2094 [01:00<06:24,  4.72it/s] 14%|█▎        | 283/2094 [01:20<06:24,  4.72it/s] 27%|██▋       | 568/2094 [02:00<05:22,  4.73it/s] 27%|██▋       | 568/2094 [02:20<05:22,  4.73it/s] 41%|████      | 855/2094 [03:00<04:20,  4.75it/s] 41%|████      | 855/2094 [03:20<04:20,  4.75it/s] 55%|█████▍    | 1146/2094 [04:00<03:17,  4.79it/s] 55%|█████▍    | 1146/2094 [04:20<03:17,  4.79it/s] 68%|██████▊   | 1427/2094 [05:00<02:20,  4.75it/s] 68%|██████▊   | 1427/2094 [05:20<02:20,  4.75it/s] 82%|████████▏ | 1710/2094 [06:00<01:21,  4.73it/s] 82%|████████▏ | 1710/2094 [06:20<01:21,  4.73it/s] 95%|█████████▍| 1989/2094 [07:00<00:22,  4.71it/s] 95%|█████████▍| 1989/2094 [07:20<00:22,  4.71it/s]100%|██████████| 2094/2094 [07:23<00:00,  4.72it/s]
  0%|          | 0/2094 [00:00<?, ?it/s]  7%|▋         | 140/2094 [01:00<13:58,  2.33it/s]  7%|▋         | 140/2094 [01:16<13:58,  2.33it/s] 13%|█▎        | 280/2094 [02:00<12:58,  2.33it/s] 13%|█▎        | 280/2094 [02:16<12:58,  2.33it/s] 20%|██        | 423/2094 [03:00<11:50,  2.35it/s] 20%|██        | 423/2094 [03:16<11:50,  2.35it/s] 27%|██▋       | 563/2094 [04:00<10:54,  2.34it/s] 27%|██▋       | 563/2094 [04:16<10:54,  2.34it/s] 34%|███▎      | 702/2094 [05:00<09:57,  2.33it/s] 34%|███▎      | 702/2094 [05:16<09:57,  2.33it/s] 40%|████      | 845/2094 [06:01<08:53,  2.34it/s] 40%|████      | 845/2094 [06:16<08:53,  2.34it/s] 47%|████▋     | 992/2094 [07:01<07:44,  2.37it/s] 47%|████▋     | 992/2094 [07:16<07:44,  2.37it/s] 54%|█████▍    | 1133/2094 [08:01<06:47,  2.36it/s] 54%|█████▍    | 1133/2094 [08:16<06:47,  2.36it/s] 61%|██████    | 1275/2094 [09:02<05:47,  2.36it/s] 61%|██████    | 1275/2094 [09:16<05:47,  2.36it/s] 68%|██████▊   | 1417/2094 [10:02<04:47,  2.36it/s] 68%|██████▊   | 1417/2094 [10:16<04:47,  2.36it/s] 74%|███████▍  | 1557/2094 [11:02<03:48,  2.35it/s] 74%|███████▍  | 1557/2094 [11:16<03:48,  2.35it/s] 81%|████████▏ | 1702/2094 [12:02<02:45,  2.37it/s] 81%|████████▏ | 1702/2094 [12:16<02:45,  2.37it/s] 88%|████████▊ | 1843/2094 [13:03<01:46,  2.36it/s] 88%|████████▊ | 1843/2094 [13:16<01:46,  2.36it/s] 95%|█████████▍| 1983/2094 [14:03<00:47,  2.35it/s] 95%|█████████▍| 1983/2094 [14:16<00:47,  2.35it/s]100%|██████████| 2094/2094 [14:51<00:00,  2.35it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                                  subj_anchors_swow                         subj_anchors_swow_sg                               subj_anchors_swow_pl                        subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]  catfish catfish catfish           5  [a catfish or a flatfish is a [MASK]., a catfi...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [citruses, lemons, limes, lemonades, lemony]      [citrus, lemon, lime, lemonade, lemony]     [citruses, lemons, limes, lemonades, lemonies]      [citrus, lemon, lime, lemonade, lemony]        lemon lemon lemon           5  [a lemon or a citrus is a [MASK]., a lemon or ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]   turtles turtle turtles           5  [a turtle or a tortoise is a [MASK]., a turtle...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]            bags bag bags           5  [a bag or a tote is a [MASK]., a bag or a lugg...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]   rabbits rabbit rabbits           5  [a rabbit or a rabbit is a [MASK]., a rabbit o...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and flatfish., [MASK] ...  [fish, seafood, shrimp, species, salmon, mollu...  {'fish': -4.441462001524424, 'seafood': -12.19...  [fish, seafood, species, animal, invertebrates...  {'fish': -5.50641807336818, 'seafood': -9.4823...  
1  [[MASK] such as lemon and citruses., [MASK] su...  [fruit, drink, beverage, lime, candy, juice, w...  {'fruit': -7.079283227321921, 'drink': -7.7792...  [fruit, citrus, product, thing, drink, beverag...  {'fruits': -6.811414946982101, 'fruit': -7.506...  
2  [[MASK] such as turtles and tortoises., [MASK]...  [animal, mammal, bird, fish, lizard, creature,...  {'animal': -7.047284659390465, 'mammal': -8.12...  [reptile, animal, invertebrates, wildlife, bir...  {'reptiles': -6.258507936940672, 'animals': -6...  
3  [[MASK] such as bags and tote., [MASK] such as...  [luggage, container, backpack, suitcase, carri...  {'luggage': -7.0207782373472964, 'container': ...  [luggage, thing, item, good, object, accessory...  {'luggage': -7.822808424960774, 'things': -8.5...  
4  [[MASK] such as rabbits and rabbits., [MASK] s...  [mammal, animal, creature, bird, dog, hare, br...  {'mammal': -6.48185866174879, 'animal': -6.842...  [animal, mammal, rodent, wildlife, livestock, ...  {'animals': -5.8782338504804175, 'mammals': -7...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	  15.1 	  44.9 	   44.9 	  25.8 
  1 	 subj_anchors_swow_all 	  15.1 	  44.9 	   44.9 	  25.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.7 	   46.8 	  23.2 	              1 
  2 	 lsp_sap     	  12.3 	  33.1 	   44.4 	  21.2 	              3 
  3 	 def_dap     	  14   	  38.3 	   49   	  24.2 	              2 
  4 	 lsp_dap     	  13.8 	  33.8 	   45.7 	  22.5 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWSimilar', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                               subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...        [flatfish, crayfish, fish, catsup, seafood]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...            [citrus, lemon, lime, lemonade, lemony]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...           [tortoise, amphibian, reptile, porpoise]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...            [tote, luggage, carrying, bag, baggage]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...            [rabbit, bunny, hare, breeding, rodent]
...                                                 ...                                                ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...  [editor, manuscript, publication, publish, lit...
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...                 [backyard, grass, acre, mow, inch]

[2094 rows x 2 columns]
                                                lsp_dap                               subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...    [flatfish, crayfish, fishes, catsups, seafoods]
1     [[MASK] such as lemon and [Z]., [MASK], includ...     [citruses, lemons, limes, lemonades, lemonies]
2     [[MASK] such as turtles and [Z]., [MASK], incl...  [tortoises, amphibian, reptile, reptiles, porp...
3     [[MASK] such as bags and [Z]., [MASK], includi...         [tote, luggages, carrying, bags, baggages]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...          [rabbits, bunny, hare, breeding, rodents]
...                                                 ...                                                ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [editors, manuscripts, publications, publish, ...
2093  [[MASK] such as yard and [Z]., [MASK], includi...            [backyard, grasses, acres, mow, inches]

[2094 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2094 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▎        | 285/2094 [01:00<06:22,  4.73it/s] 14%|█▎        | 285/2094 [01:20<06:22,  4.73it/s] 27%|██▋       | 568/2094 [02:00<05:23,  4.72it/s] 27%|██▋       | 568/2094 [02:20<05:23,  4.72it/s] 41%|████      | 857/2094 [03:00<04:20,  4.76it/s] 41%|████      | 857/2094 [03:20<04:20,  4.76it/s] 55%|█████▍    | 1149/2094 [04:00<03:16,  4.80it/s] 55%|█████▍    | 1149/2094 [04:20<03:16,  4.80it/s] 68%|██████▊   | 1432/2094 [05:00<02:18,  4.77it/s] 68%|██████▊   | 1432/2094 [05:20<02:18,  4.77it/s] 82%|████████▏ | 1717/2094 [06:00<01:19,  4.76it/s] 82%|████████▏ | 1717/2094 [06:20<01:19,  4.76it/s] 95%|█████████▌| 1998/2094 [07:00<00:20,  4.73it/s] 95%|█████████▌| 1998/2094 [07:20<00:20,  4.73it/s]100%|██████████| 2094/2094 [07:21<00:00,  4.74it/s]
  0%|          | 0/2094 [00:00<?, ?it/s]  7%|▋         | 141/2094 [01:00<13:53,  2.34it/s]  7%|▋         | 141/2094 [01:18<13:53,  2.34it/s] 13%|█▎        | 282/2094 [02:00<12:53,  2.34it/s] 13%|█▎        | 282/2094 [02:18<12:53,  2.34it/s] 20%|██        | 426/2094 [03:00<11:46,  2.36it/s] 20%|██        | 426/2094 [03:18<11:46,  2.36it/s] 27%|██▋       | 566/2094 [04:00<10:50,  2.35it/s] 27%|██▋       | 566/2094 [04:18<10:50,  2.35it/s] 34%|███▎      | 706/2094 [05:01<09:53,  2.34it/s] 34%|███▎      | 706/2094 [05:18<09:53,  2.34it/s] 41%|████      | 849/2094 [06:01<08:48,  2.35it/s] 41%|████      | 849/2094 [06:18<08:48,  2.35it/s] 48%|████▊     | 996/2094 [07:01<07:40,  2.38it/s] 48%|████▊     | 996/2094 [07:19<07:40,  2.38it/s] 54%|█████▍    | 1137/2094 [08:01<06:43,  2.37it/s] 54%|█████▍    | 1137/2094 [08:19<06:43,  2.37it/s] 61%|██████    | 1279/2094 [09:01<05:44,  2.37it/s] 61%|██████    | 1279/2094 [09:19<05:44,  2.37it/s] 68%|██████▊   | 1421/2094 [10:02<04:44,  2.36it/s] 68%|██████▊   | 1421/2094 [10:19<04:44,  2.36it/s] 75%|███████▍  | 1561/2094 [11:02<03:46,  2.35it/s] 75%|███████▍  | 1561/2094 [11:19<03:46,  2.35it/s] 82%|████████▏ | 1707/2094 [12:02<02:43,  2.37it/s] 82%|████████▏ | 1707/2094 [12:19<02:43,  2.37it/s] 88%|████████▊ | 1848/2094 [13:02<01:44,  2.36it/s] 88%|████████▊ | 1848/2094 [13:19<01:44,  2.36it/s] 95%|█████████▍| 1988/2094 [14:03<00:45,  2.35it/s] 95%|█████████▍| 1988/2094 [14:19<00:45,  2.35it/s]100%|██████████| 2094/2094 [14:48<00:00,  2.36it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                                  subj_anchors_swow                         subj_anchors_swow_sg                               subj_anchors_swow_pl                        subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]  catfish catfish catfish           5  [a catfish or a flatfish is a [MASK]., a catfi...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [citruses, lemons, limes, lemonades, lemony]      [citrus, lemon, lime, lemonade, lemony]     [citruses, lemons, limes, lemonades, lemonies]      [citrus, lemon, lime, lemonade, lemony]        lemon lemon lemon           5  [a lemon or a citrus is a [MASK]., a lemon or ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]   turtles turtle turtles           5  [a turtle or a tortoise is a [MASK]., a turtle...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]            bags bag bags           5  [a bag or a tote is a [MASK]., a bag or a lugg...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]   rabbits rabbit rabbits           5  [a rabbit or a rabbit is a [MASK]., a rabbit o...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and flatfish., [MASK] ...  [fish, seafood, shrimp, species, salmon, mollu...  {'fish': -4.441462001524424, 'seafood': -12.19...  [fish, seafood, species, animal, invertebrates...  {'fish': -5.50641807336818, 'seafood': -9.4823...  
1  [[MASK] such as lemon and citruses., [MASK] su...  [fruit, drink, beverage, lime, candy, juice, w...  {'fruit': -7.079283227321921, 'drink': -7.7792...  [fruit, citrus, product, thing, drink, beverag...  {'fruits': -6.811414946982101, 'fruit': -7.506...  
2  [[MASK] such as turtles and tortoises., [MASK]...  [animal, mammal, bird, fish, lizard, creature,...  {'animal': -7.047284659390465, 'mammal': -8.12...  [reptile, animal, invertebrates, wildlife, bir...  {'reptiles': -6.258507936940672, 'animals': -6...  
3  [[MASK] such as bags and tote., [MASK] such as...  [luggage, container, backpack, suitcase, carri...  {'luggage': -7.0207782373472964, 'container': ...  [luggage, thing, item, good, object, accessory...  {'luggage': -7.822808424960774, 'things': -8.5...  
4  [[MASK] such as rabbits and rabbits., [MASK] s...  [mammal, animal, creature, bird, dog, hare, br...  {'mammal': -6.48185866174879, 'animal': -6.842...  [animal, mammal, rodent, wildlife, livestock, ...  {'animals': -5.8782338504804175, 'mammals': -7...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	  15.1 	  44.9 	   44.9 	  25.8 
  1 	 subj_anchors_swow_all 	  15.1 	  44.9 	   44.9 	  25.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.7 	   46.8 	  23.2 	              1 
  2 	 lsp_sap     	  12.3 	  33.1 	   44.4 	  21.2 	              3 
  3 	 def_dap     	  14   	  38.3 	   49   	  24.2 	              2 
  4 	 lsp_dap     	  13.8 	  33.8 	   45.7 	  22.5 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.csv
debug: False
---------------------------------------- config ----------------------------------------
{'debug': False, 'test_relations': ['IsA'], 'save_all_data': True, 'top_k': 10, 'data_dir': 'data/hypernymsuite/ALL/swow_rw/', 'mask_string_mapping': {'bert-large-uncased': '[MASK]'}, 'use_dap_global': True, 'return_probs': True, 'anchor_scorer_list': ['probAvg'], 'scorer_target_1_prompt': 'probSum', 'scorer_target_N_prompts': 'freqProbLogSum', 'use_original_prompt': True, 'original_prompt_source': 'masked_sentence', 'incorporate_operations': ['concate_or_single'], 'filter_anchors_flag': True, 'filter_objects_flag': True, 'cpt_only': False, 'anchor_types': ['Coordinate_remove_Y_PUNC_FULL'], 'add_cpt_score': False, 'constrain_targets': False, 'only_wordnet_anchor': False, 'add_wordnet_path_score': False, 'add_wordnet_filter': False, 'anchor_probe': 'plural_probe', 'anchor_col_prefix': 'subj_anchors_swow', 'anchor_col': 'subj_anchors_swow', 'anchor_col_sg': 'subj_anchors_swow_sg', 'anchor_col_pl': 'subj_anchors_swow_pl', 'anchor_col_all': 'anchor_col_all', 'filter_objects_with_input': True, 'sub_col': 'sub_label', 'sub_col_sg': 'sub_label_sg', 'sub_col_pl': 'sub_label_pl', 'top_k_anchors': 5, 'max_anchor_num_list': [10], 'max_anchor_num': 10, 'sub_col_sgpl': 'sub_label_sgpl', 'filter_objects_with_anchors': False, 'oracle_anchor_inserted': False, 'use_oracle_anchor': True, 'anchor_source': 'SWOW', 'only_swow_anchor': True, 'add_swow_score': False, 'swow_score_source': 'OnlySWOWSimilar', 'add_swow_filter': False, 'dataset': 'ALLSWOW'}
---------------------------------------- config ----------------------------------------
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
reading cohyponyms: pre_post_process/log/word_to_cohyponyms_score_pl.json
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at bert-large-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
---------------------------------------- bert-large-uncased-anchor_type: Coordinate_remove_Y_PUNC_FULL-scorer_anchor:probAvg-op:concate_or_single ----------------------------------------
{
    "IsA": {
        "relation": "IsA",
        "def_sap": [
            "[X] is a [MASK].",
            "[X] is a type of [MASK].",
            "[X] is a kind of [MASK]."
        ],
        "def_dap": [
            "[X] or [Z] is a [MASK].",
            "[X] or [Z] is a type of [MASK].",
            "[X] or [Z] is a kind of [MASK]."
        ],
        "lsp_sap": [
            "[MASK] such as [X].",
            "[MASK], including [X].",
            "[MASK], especially [X].",
            "[X] or other [MASK].",
            "[X] and other [MASK].",
            "such [MASK] as [X]."
        ],
        "lsp_dap": [
            "[MASK] such as [X] and [Z].",
            "[MASK], including [X] and [Z].",
            "[MASK], especially [X] and [Z].",
            "[X], [Z] and other [MASK].",
            "[X], [Z] or other [MASK].",
            "such [MASK] as [X] and [Z]."
        ],
        "use_dap": true,
        "anchor_target": "[X]",
        "anchor_lsp_sap": [
            "such as [X] and [MASK].",
            "such as [X] or [MASK].",
            "such as [X], [MASK],",
            "including [X] and [MASK].",
            "including [X] or [MASK].",
            "including [X], [MASK],",
            "especially [X] and [MASK].",
            "especially [X] or [MASK].",
            "especially [X], [MASK],",
            "[X], [MASK] or other",
            "[X], [MASK] and other"
        ]
    }
}
Processing IsA ... data/hypernymsuite/ALL/swow_rw//IsA.jsonl
#All Instances: 2094
#Valid Instances: 2094 in ALLSWOW (hyper in BERT)
	 step1: get anchors (fill and filter)
/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
--- def_sap
--- lsp_sap
relation: IsA 	 use_dap: True
	 step2: insert anchors
sub_col sub_label
                                                def_dap                               subj_anchors_swow_sg
0     [a catfish or [Z] is a [MASK]., a catfish or [...        [flatfish, crayfish, fish, catsup, seafood]
1     [a lemon or [Z] is a [MASK]., a lemon or [Z] i...            [citrus, lemon, lime, lemonade, lemony]
2     [a turtle or [Z] is a [MASK]., a turtle or [Z]...           [tortoise, amphibian, reptile, porpoise]
3     [a bag or [Z] is a [MASK]., a bag or [Z] is a ...            [tote, luggage, carrying, bag, baggage]
4     [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...            [rabbit, bunny, hare, breeding, rodent]
...                                                 ...                                                ...
2089  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2090  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2091  [a world or [Z] is a [MASK]., a world or [Z] i...       [global, geography, earth, atlas, continent]
2092  [a writer or [Z] is a [MASK]., a writer or [Z]...  [editor, manuscript, publication, publish, lit...
2093  [a yard or [Z] is a [MASK]., a yard or [Z] is ...                 [backyard, grass, acre, mow, inch]

[2094 rows x 2 columns]
                                                lsp_dap                               subj_anchors_swow_pl
0     [[MASK] such as catfish and [Z]., [MASK], incl...    [flatfish, crayfish, fishes, catsups, seafoods]
1     [[MASK] such as lemon and [Z]., [MASK], includ...     [citruses, lemons, limes, lemonades, lemonies]
2     [[MASK] such as turtles and [Z]., [MASK], incl...  [tortoises, amphibian, reptile, reptiles, porp...
3     [[MASK] such as bags and [Z]., [MASK], includi...         [tote, luggages, carrying, bags, baggages]
4     [[MASK] such as rabbits and [Z]., [MASK], incl...          [rabbits, bunny, hare, breeding, rodents]
...                                                 ...                                                ...
2089  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2090  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2091  [[MASK] such as worlds and [Z]., [MASK], inclu...   [global, geographies, earths, atlas, continents]
2092  [[MASK] such as writers and [Z]., [MASK], incl...  [editors, manuscripts, publications, publish, ...
2093  [[MASK] such as yard and [Z]., [MASK], includi...            [backyard, grasses, acres, mow, inches]

[2094 rows x 2 columns]
	 step3: fill mask in dap anchors
  0%|          | 0/2094 [00:00<?, ?it/s]/home/chunhua/.local/lib/python3.8/site-packages/transformers/pipelines/base.py:1043: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  warnings.warn(
 14%|█▎        | 287/2094 [01:00<06:18,  4.78it/s] 14%|█▎        | 287/2094 [01:20<06:18,  4.78it/s] 28%|██▊       | 576/2094 [02:00<05:16,  4.79it/s] 28%|██▊       | 576/2094 [02:20<05:16,  4.79it/s] 41%|████▏     | 868/2094 [03:00<04:14,  4.82it/s] 41%|████▏     | 868/2094 [03:20<04:14,  4.82it/s] 56%|█████▌    | 1163/2094 [04:00<03:11,  4.85it/s] 56%|█████▌    | 1163/2094 [04:20<03:11,  4.85it/s] 69%|██████▉   | 1449/2094 [05:00<02:13,  4.82it/s] 69%|██████▉   | 1449/2094 [05:20<02:13,  4.82it/s] 83%|████████▎ | 1736/2094 [06:00<01:14,  4.81it/s] 83%|████████▎ | 1736/2094 [06:20<01:14,  4.81it/s] 96%|█████████▋| 2019/2094 [07:00<00:15,  4.78it/s]100%|██████████| 2094/2094 [07:16<00:00,  4.80it/s]
  0%|          | 0/2094 [00:00<?, ?it/s]  7%|▋         | 142/2094 [01:00<13:45,  2.36it/s]  7%|▋         | 142/2094 [01:13<13:45,  2.36it/s] 14%|█▎        | 284/2094 [02:00<12:45,  2.36it/s] 14%|█▎        | 284/2094 [02:13<12:45,  2.36it/s] 20%|██        | 429/2094 [03:00<11:38,  2.38it/s] 20%|██        | 429/2094 [03:13<11:38,  2.38it/s] 27%|██▋       | 571/2094 [04:00<10:42,  2.37it/s] 27%|██▋       | 571/2094 [04:13<10:42,  2.37it/s] 34%|███▍      | 714/2094 [05:01<09:42,  2.37it/s] 34%|███▍      | 714/2094 [05:13<09:42,  2.37it/s] 41%|████      | 857/2094 [06:01<08:41,  2.37it/s] 41%|████      | 857/2094 [06:13<08:41,  2.37it/s] 48%|████▊     | 1005/2094 [07:01<07:33,  2.40it/s] 48%|████▊     | 1005/2094 [07:13<07:33,  2.40it/s] 55%|█████▍    | 1148/2094 [08:01<06:35,  2.39it/s] 55%|█████▍    | 1148/2094 [08:13<06:35,  2.39it/s] 62%|██████▏   | 1292/2094 [09:01<05:35,  2.39it/s] 62%|██████▏   | 1292/2094 [09:13<05:35,  2.39it/s] 69%|██████▊   | 1435/2094 [10:02<04:36,  2.39it/s] 69%|██████▊   | 1435/2094 [10:13<04:36,  2.39it/s] 75%|███████▌  | 1577/2094 [11:02<03:37,  2.38it/s] 75%|███████▌  | 1577/2094 [11:13<03:37,  2.38it/s] 82%|████████▏ | 1724/2094 [12:02<02:34,  2.40it/s] 82%|████████▏ | 1724/2094 [12:13<02:34,  2.40it/s] 89%|████████▉ | 1867/2094 [13:03<01:35,  2.39it/s] 89%|████████▉ | 1867/2094 [13:13<01:35,  2.39it/s] 96%|█████████▌| 2009/2094 [14:03<00:35,  2.38it/s] 96%|█████████▌| 2009/2094 [14:23<00:35,  2.38it/s]100%|██████████| 2094/2094 [14:39<00:00,  2.38it/s]
  sub_label   obj_label relation  obj_in_BERT         masked_sentences  uuid  sub_position sub_label_sg sub_label_pl                                            def_sap                                            def_dap                                            lsp_sap                                            lsp_dap                                     anchor_lsp_sap           sub_label_sgpl                                  obj_mask_sentence                            obj_mask_sentence_score                                   obj_mask_def_sap                             obj_mask_def_sap_score                                   obj_mask_lsp_sap                             obj_mask_lsp_sap_score                                  subj_anchors_swow                         subj_anchors_swow_sg                               subj_anchors_swow_pl                        subj_anchors_swow_all    subj_anchors_combined  anchor_num                           def_dap_with_subj_anchor  \
0   catfish      [fish]      IsA            1  [A catfish is a [MASK]]     1             2      catfish      catfish  [a catfish is a [MASK]., a catfish is a type o...  [a catfish or [Z] is a [MASK]., a catfish or [...  [[MASK] such as catfish., [MASK], including ca...  [[MASK] such as catfish and [Z]., [MASK], incl...  [such as catfish and [MASK]., such as catfish ...  catfish catfish catfish  [fish, boat, river, genus, gastropod, lizard, ...  {'fish': -17.492517940945792, 'boat': -19.0523...  [fish, shrimp, mollusk, swimmer, salmon, bird,...  {'fish': -4.442973047064299, 'shrimp': -12.345...  [fish, species, animal, seafood, reptile, inve...  {'fish': -4.942579534624883, 'species': -9.299...    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]    [flatfish, crayfish, fishes, catsups, seafoods]  [flatfish, crayfish, fish, catsup, seafood]  catfish catfish catfish           5  [a catfish or a flatfish is a [MASK]., a catfi...   
1     lemon   [produce]      IsA            1    [A lemon is a [MASK]]     2             2        lemon        lemon  [a lemon is a [MASK]., a lemon is a type of [M...  [a lemon or [Z] is a [MASK]., a lemon or [Z] i...  [[MASK] such as lemon., [MASK], including lemo...  [[MASK] such as lemon and [Z]., [MASK], includ...  [such as lemon and [MASK]., such as lemon or [...        lemon lemon lemon  [fruit, tree, person, bottle, key, seed, twist...  {'fruit': -15.145185477808239, 'tree': -15.459...  [fruit, drink, lime, candy, apple, orange, ber...  {'fruit': -7.934486012665629, 'drink': -10.454...  [fruit, citrus, apple, thing, orange, lime, wa...  {'fruit': -7.175187479938773, 'fruits': -7.897...       [citruses, lemons, limes, lemonades, lemony]      [citrus, lemon, lime, lemonade, lemony]     [citruses, lemons, limes, lemonades, lemonies]      [citrus, lemon, lime, lemonade, lemony]        lemon lemon lemon           5  [a lemon or a citrus is a [MASK]., a lemon or ...   
2   turtles     [beast]      IsA            1   [A turtle is a [MASK]]     3             2       turtle      turtles  [a turtle is a [MASK]., a turtle is a type of ...  [a turtle or [Z] is a [MASK]., a turtle or [Z]...  [[MASK] such as turtles., [MASK], including tu...  [[MASK] such as turtles and [Z]., [MASK], incl...  [such as turtles and [MASK]., such as turtles ...   turtles turtle turtles   [lizard, person, shell, boat, human, fish, tree]  {'lizard': -16.036533980021577, 'person': -16....  [bird, animal, fish, mammal, creature, lizard,...  {'bird': -6.983079495727402, 'animal': -7.2181...  [reptile, animal, bird, creature, wildlife, in...  {'reptiles': -6.12624919356388, 'animals': -6....  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]  [tortoises, amphibian, reptile, reptiles, porp...     [tortoise, amphibian, reptile, porpoise]   turtles turtle turtles           5  [a turtle or a tortoise is a [MASK]., a turtle...   
3      bags   [luggage]      IsA            1      [A bag is a [MASK]]     4             2          bag         bags  [a bag is a [MASK]., a bag is a type of [MASK]...  [a bag or [Z] is a [MASK]., a bag or [Z] is a ...  [[MASK] such as bags., [MASK], including bags....  [[MASK] such as bags and [Z]., [MASK], includi...  [such as bags and [MASK]., such as bags or [MA...            bags bag bags  [person, box, pouch, pack, container, suitcase...  {'person': -15.800401335816666, 'box': -16.478...  [container, luggage, backpack, suitcase, sack,...  {'container': -8.861242617076943, 'luggage': -...  [thing, item, object, luggage, belongings, acc...  {'things': -7.206912668513597, 'items': -8.137...         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]         [tote, luggages, carrying, bags, baggages]      [tote, luggage, carrying, bag, baggage]            bags bag bags           5  [a bag or a tote is a [MASK]., a bag or a lugg...   
4   rabbits  [creature]      IsA            1   [A rabbit is a [MASK]]     5             2       rabbit      rabbits  [a rabbit is a [MASK]., a rabbit is a type of ...  [a rabbit or [Z] is a [MASK]., a rabbit or [Z]...  [[MASK] such as rabbits., [MASK], including ra...  [[MASK] such as rabbits and [Z]., [MASK], incl...  [such as rabbits and [MASK]., such as rabbits ...   rabbits rabbit rabbits  [person, horse, human, dog, man, child, pig, k...  {'person': -15.755672171378398, 'horse': -15.9...  [animal, mammal, dog, bird, cat, fox, pig, har...  {'animal': -6.5751558948461675, 'mammal': -8.9...  [animal, rodent, mammal, wildlife, livestock, ...  {'animals': -5.903334231711103, 'rodents': -7....          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]          [rabbits, bunny, hare, breeding, rodents]      [rabbit, bunny, hare, breeding, rodent]   rabbits rabbit rabbits           5  [a rabbit or a rabbit is a [MASK]., a rabbit o...   

                            lsp_dap_with_subj_anchor                                   obj_mask_def_dap                             obj_mask_def_dap_score                                   obj_mask_lsp_dap                             obj_mask_lsp_dap_score  
0  [[MASK] such as catfish and flatfish., [MASK] ...  [fish, seafood, shrimp, species, salmon, mollu...  {'fish': -4.441462001524424, 'seafood': -12.19...  [fish, seafood, species, animal, invertebrates...  {'fish': -5.50641807336818, 'seafood': -9.4823...  
1  [[MASK] such as lemon and citruses., [MASK] su...  [fruit, drink, beverage, lime, candy, juice, w...  {'fruit': -7.079283227321921, 'drink': -7.7792...  [fruit, citrus, product, thing, drink, beverag...  {'fruits': -6.811414946982101, 'fruit': -7.506...  
2  [[MASK] such as turtles and tortoises., [MASK]...  [animal, mammal, bird, fish, lizard, creature,...  {'animal': -7.047284659390465, 'mammal': -8.12...  [reptile, animal, invertebrates, wildlife, bir...  {'reptiles': -6.258507936940672, 'animals': -6...  
3  [[MASK] such as bags and tote., [MASK] such as...  [luggage, container, backpack, suitcase, carri...  {'luggage': -7.0207782373472964, 'container': ...  [luggage, thing, item, good, object, accessory...  {'luggage': -7.822808424960774, 'things': -8.5...  
4  [[MASK] such as rabbits and rabbits., [MASK] s...  [mammal, animal, creature, bird, dog, hare, br...  {'mammal': -6.48185866174879, 'animal': -6.842...  [animal, mammal, rodent, wildlife, livestock, ...  {'animals': -5.8782338504804175, 'mammals': -7...  
---------------------------------------- anchor evaluation ----------------------------------------
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:832: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'p{k}_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: concept_evaluation(x[0], eval(x[1])[:k] if isinstance(x[1], str) else x[1][:k]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
anchored_prompts.py:905: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[f'mrr_{suffix}'] = df[[label_col, pred_col]].apply(lambda x: get_highest_mrr_among_labels(x[0], x[1]), axis=1 )
begin{tabular}{rlrrrr}
hline
    	 mask_type             	   p@1 	   p@5 	   p@10 	   mrr 
hline
  0 	 subj_anchors_swow_sg  	  15.1 	  44.9 	   44.9 	  25.8 
  1 	 subj_anchors_swow_all 	  15.1 	  44.9 	   44.9 	  25.8 
hline
end{tabular}
---------------------------------------- obj_label evaluation ----------------------------------------
begin{tabular}{rlrrrrr}
hline
    	 mask_type   	   p@1 	   p@5 	   p@10 	   mrr 	   mask_type_id 
hline
  1 	 def_sap     	  13.3 	  36.7 	   46.8 	  23.2 	              1 
  2 	 lsp_sap     	  12.3 	  33.1 	   44.4 	  21.2 	              3 
  3 	 def_dap     	  14   	  38.3 	   49   	  24.2 	              2 
  4 	 lsp_dap     	  13.8 	  33.8 	   45.7 	  22.5 	              4 
hline
end{tabular}
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.tsv
save log/bert-large-uncased/ALL/swow_rw/df_all_use_global_dap_True_max_anchor_num_5_anchor_scorer_probAvg_filter_obj_True_filter_objects_with_input_True_anchor_source_SWOW_wns_False_wnf_False_swow_score_source_OnlySWOWSimilar.ALLSWOW.csv
